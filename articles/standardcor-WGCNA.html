<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>standardcor-WGCNA • standardcor</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="standardcor-WGCNA">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">standardcor</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Getting-Started.html">Getting-Started</a></li>
    <li><a class="dropdown-item" href="../articles/standardcor-WGCNA.html">standardcor-WGCNA</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>standardcor-WGCNA</h1>
            
      

      <div class="d-none name"><code>standardcor-WGCNA.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://longevity-consortium.github.io/standardcor/">standardcor</a></span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: qlcMatrix</span></span>
<span><span class="co">#&gt; Loading required package: Matrix</span></span>
<span><span class="co">#&gt; Loading required package: slam</span></span>
<span><span class="co">#&gt; Loading required package: sparsesvd</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">WGCNA</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: dynamicTreeCut</span></span>
<span><span class="co">#&gt; Loading required package: fastcluster</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'fastcluster'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     hclust</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'WGCNA'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     cor</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Attaching core tidyverse packages</span> ──────────────────────── tidyverse 2.0.0 ──</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">dplyr    </span> 1.1.4     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">readr    </span> 2.1.5</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">forcats  </span> 1.0.0     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">stringr  </span> 1.5.1</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">ggplot2  </span> 3.5.1     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tibble   </span> 3.2.1</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">lubridate</span> 1.9.3     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tidyr    </span> 1.3.1</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">purrr    </span> 1.0.2</span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Conflicts</span> ────────────────────────────────────────── tidyverse_conflicts() ──</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">tidyr</span>::<span style="color: #00BB00;">expand()</span> masks <span style="color: #0000BB;">Matrix</span>::expand()</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">filter()</span> masks <span style="color: #0000BB;">stats</span>::filter()</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">lag()</span>    masks <span style="color: #0000BB;">stats</span>::lag()</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">purrr</span>::<span style="color: #00BB00;">none()</span>   masks <span style="color: #0000BB;">qlcMatrix</span>::none()</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">tidyr</span>::<span style="color: #00BB00;">pack()</span>   masks <span style="color: #0000BB;">Matrix</span>::pack()</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">tidyr</span>::<span style="color: #00BB00;">unpack()</span> masks <span style="color: #0000BB;">Matrix</span>::unpack()</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use the conflicted package (<span style="color: #0000BB; font-style: italic;">&lt;http://conflicted.r-lib.org/&gt;</span>) to force all conflicts to become errors</span></span></code></pre></div>
<div class="section level2">
<h2 id="wgcna-integration-of-multi-omics">WGCNA, Integration of multi-omics<a class="anchor" aria-label="anchor" href="#wgcna-integration-of-multi-omics"></a>
</h2>
<p>This notebook covers a correlation standardization technique (more
information here: <a href="https://github.com/PriceLab/standardcor" class="external-link uri">https://github.com/PriceLab/standardcor</a>) to combine
omics for a downstream WGCNA analysis. To combine omics, we start with
correlations separately by each omics. Each omics tends to have a
different distribution of correlations; for example, randomly selected
analytes from a proteomics assay tends to be positively correlated (also
true for transcriptomics), but randomly selected metabolites are
typically closer to uncorrelated. This is not an issue when computing
adjacencies for any of the single ’omics, because the transformation
from correlations to adjacencies would (in WGCNA) be fit to each of
these separate distributions separately. When we combine correlations
across different ’omics, or between analytes measured in different
’omics experiments, WGCNA would attempt to find one power 𝑘 to fit them
all, and that would result in very different distributions of adjacency
for analyte pairs from different source experiments. One particular
source of differences in distribution is sample size. If we compute
correlations between metabolites from 1,000 individuals, we should
expect much more accurate correlation values than if we compute them
from only 10; sampling variation alone will result in a sqrt(1000/10) =
10-fold difference in variance!</p>
<p>We will therefore make a smooth model of the distribution of
correlations of each type, and then transform the correlation values to
a single, shared smooth model. While the resulting values are no longer
interpretable as correlations, this will standardize the significance of
correlations from different sources onto a single, shared significance
scale. When WGCNA fits the values on this scale, it will be applying the
same significance standards to all the correlations, regardless of their
original source.</p>
<div class="section level3">
<h3 id="data-and-preprocessing">Data and preprocessing<a class="anchor" aria-label="anchor" href="#data-and-preprocessing"></a>
</h3>
<p>The required input files are:</p>
<ul>
<li>Phenotype Table - containing the outcome of inPrimary Merest</li>
<li>MetabolitPrimary e Table - metabolite abunda</li>
<li>Lipid Table - Lipid abundance values</li>
<li>Biogenic Amine Table - Biogenic Amine Tablence values</li>
<li>Protein Table - protein abundance values</li>
</ul>
<p>Data for this analysis were synthesized from Longevity Consortium
generated proteomic and metabolomic data. We used a Gaussian Mixture
Model (GMM) to create 1000 synthetic participants for each omic type,
500 cases and 500 controls, followed by the addition of a synthetic
case/control signal. The signal was generated by adding 0.1 to a set of
proteins and metabolites for all cases.</p>
<p>The original Longevity Consortium datasets were filtered for high
missingness (&gt;20%), imputed using random-forest imputation and log
normalized prior to running GMM.</p>
</div>
<div class="section level3">
<h3 id="load-data">Load data<a class="anchor" aria-label="anchor" href="#load-data"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Phenotypes</span></span>
<span><span class="va">pheno</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_delim</a></span><span class="op">(</span><span class="st">"../data/WGCNA/case_synth.tsv"</span>, show_col_types <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">### Load proteins</span></span>
<span><span class="va">prots</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_delim</a></span><span class="op">(</span><span class="st">"../data/WGCNA/proteins_synth.tsv"</span>, show_col_types <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">### Metabolites</span></span>
<span><span class="va">lipids_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_delim</a></span><span class="op">(</span><span class="st">"../data/WGCNA/Lipids_synth.tsv"</span>, show_col_types <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">amines_df</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_delim</a></span><span class="op">(</span><span class="st">"../data/WGCNA/BA_synth.tsv"</span>, show_col_types <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">primary_df</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_delim</a></span><span class="op">(</span><span class="st">"../data/WGCNA/Primary_synth.tsv"</span>, show_col_types <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span> </span>
<span><span class="co">### Metabolite features</span></span>
<span><span class="va">features</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_delim</a></span><span class="op">(</span><span class="st">"../data/WGCNA/Met_Features.tsv"</span>, show_col_types <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Merge together</span></span>
<span><span class="va">in_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">primary_df</span>, <span class="va">lipids_df</span>, by<span class="op">=</span><span class="st">"subjectID"</span><span class="op">)</span></span>
<span><span class="va">in_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">in_df</span>, <span class="va">amines_df</span>, by<span class="op">=</span><span class="st">"subjectID"</span><span class="op">)</span></span>
<span><span class="va">in_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">in_df</span>, <span class="va">prots</span>, by<span class="op">=</span><span class="st">"subjectID"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check dimensions of each dataframe</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">primary_df</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 500 150</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">lipids_df</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 500 713</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">amines_df</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 500 322</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">prots</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 500 284</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">in_df</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  500 1466</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">pheno</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 500   2</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Drop id column and get features</span></span>
<span><span class="va">num.analytes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">primary_df</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">lipids_df</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">amines_df</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">prots</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,<span class="st">'subjectID'</span><span class="op">)</span></span>
<span><span class="va">num_df</span> <span class="op">&lt;-</span> <span class="va">in_df</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">in_df</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">num.analytes</span><span class="op">]</span></span>
<span><span class="va">num_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">num_df</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">num_df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">in_df</span><span class="op">$</span><span class="va">subjectID</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Filter samples and features based on WGCNA NA criteria (50%)</span></span>
<span><span class="va">gsg</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/WGCNA/man/goodSamplesGenes.html" class="external-link">goodSamplesGenes</a></span><span class="op">(</span><span class="va">num_df</span>, verbose <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>;</span>
<span><span class="co">#&gt;  Flagging genes and samples with too many missing values...</span></span>
<span><span class="co">#&gt;   ..step 1</span></span>
<span><span class="va">gsg</span><span class="op">$</span><span class="va">allOK</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="va">gsg</span><span class="op">$</span><span class="va">allOK</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>  <span class="co"># Optionally, print the gene and sample names that were removed:</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="va">gsg</span><span class="op">$</span><span class="va">goodGenes</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">)</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/dynamicTreeCut/man/printFlush.html" class="external-link">printFlush</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Removing genes:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">num_df</span><span class="op">)</span><span class="op">[</span><span class="op">!</span><span class="va">gsg</span><span class="op">$</span><span class="va">goodGenes</span><span class="op">]</span>, collapse <span class="op">=</span> <span class="st">", "</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>;</span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="va">gsg</span><span class="op">$</span><span class="va">goodSamples</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">)</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/dynamicTreeCut/man/printFlush.html" class="external-link">printFlush</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Removing samples:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">num_df</span><span class="op">)</span><span class="op">[</span><span class="op">!</span><span class="va">gsg</span><span class="op">$</span><span class="va">goodSamples</span><span class="op">]</span>, collapse <span class="op">=</span> <span class="st">", "</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>;</span>
<span>  <span class="co"># Remove the offending genes and samples from the data:</span></span>
<span>  <span class="va">num_df</span> <span class="op">=</span> <span class="va">num_df</span><span class="op">[</span><span class="va">gsg</span><span class="op">$</span><span class="va">goodSamples</span>, <span class="va">gsg</span><span class="op">$</span><span class="va">goodGenes</span><span class="op">]</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">num_df</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  500 1465</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get the names of remaining analytes overall (all.analytes) by category</span></span>
<span><span class="va">cat.prots</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">intersect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">prots</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">num_df</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cat.primary</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">intersect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">primary_df</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">num_df</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cat.lipid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">intersect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">lipids_df</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">num_df</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cat.amines</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">intersect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">amines_df</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">num_df</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">all.analytes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">cat.prots</span>,<span class="va">cat.primary</span>,<span class="va">cat.lipid</span>,<span class="va">cat.amines</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">cat.prots</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">cat.lipid</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">cat.primary</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">cat.amines</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">all.analytes</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "283 712 149 321 1465"</span></span>
<span></span>
<span><span class="co"># We will construct a correlation matrix Z in parts corresponding to each category of analyte pairs.</span></span>
<span><span class="va">n.analytes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">all.analytes</span><span class="op">)</span></span>
<span><span class="co"># To compute correlations, features must be numeric. We will use Spearman</span></span>
<span><span class="va">all_df</span> <span class="op">&lt;-</span> <span class="va">num_df</span><span class="op">[</span>,<span class="va">all.analytes</span><span class="op">]</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="generate-correlations">Generate Correlations<a class="anchor" aria-label="anchor" href="#generate-correlations"></a>
</h3>
<p>We use an implementation of sparse spearman correlation which saves
memory and time. This helps to prevent the notebook from crashing! We
use Spearman rank correlationsince it is not affected by scalar
multiples or by log-transformation. More information on this technique
can be found here: <a href="https://github.com/saketkc/blog/blob/main/2022-03-10/SparseSpearmanCorrelation2.ipynbs" class="external-link uri">https://github.com/saketkc/blog/blob/main/2022-03-10/SparseSpearmanCorrelation2.ipynbs</a></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">s.prots</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/as.html" class="external-link">as</a></span><span class="op">(</span><span class="va">all_df</span><span class="op">[</span>,<span class="va">cat.prots</span><span class="op">]</span>, <span class="st">"sparseMatrix"</span><span class="op">)</span></span>
<span><span class="va">s.primary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/as.html" class="external-link">as</a></span><span class="op">(</span><span class="va">all_df</span><span class="op">[</span>,<span class="va">cat.primary</span><span class="op">]</span>, <span class="st">"sparseMatrix"</span><span class="op">)</span></span>
<span><span class="va">s.lipid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/as.html" class="external-link">as</a></span><span class="op">(</span><span class="va">all_df</span><span class="op">[</span>,<span class="va">cat.lipid</span><span class="op">]</span>, <span class="st">"sparseMatrix"</span><span class="op">)</span></span>
<span><span class="va">s.amines</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/as.html" class="external-link">as</a></span><span class="op">(</span><span class="va">all_df</span><span class="op">[</span>,<span class="va">cat.amines</span><span class="op">]</span>, <span class="st">"sparseMatrix"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Within-category correlations</span></span>
<span><span class="va">Z.pp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SparseSpearmanCor2.html">SparseSpearmanCor2</a></span><span class="op">(</span><span class="va">s.prots</span><span class="op">)</span></span>
<span><span class="va">Z.mm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SparseSpearmanCor2.html">SparseSpearmanCor2</a></span><span class="op">(</span><span class="va">s.primary</span><span class="op">)</span></span>
<span><span class="va">Z.ll</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SparseSpearmanCor2.html">SparseSpearmanCor2</a></span><span class="op">(</span><span class="va">s.lipid</span><span class="op">)</span></span>
<span><span class="va">Z.aa</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SparseSpearmanCor2.html">SparseSpearmanCor2</a></span><span class="op">(</span><span class="va">s.amines</span><span class="op">)</span></span>
<span><span class="co"># Cross-category correlations</span></span>
<span><span class="va">Z.pm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SparseSpearmanCor2.html">SparseSpearmanCor2</a></span><span class="op">(</span><span class="va">s.prots</span>, <span class="va">s.primary</span><span class="op">)</span></span>
<span><span class="va">Z.pl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SparseSpearmanCor2.html">SparseSpearmanCor2</a></span><span class="op">(</span><span class="va">s.prots</span>, <span class="va">s.lipid</span><span class="op">)</span></span>
<span><span class="va">Z.pa</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SparseSpearmanCor2.html">SparseSpearmanCor2</a></span><span class="op">(</span><span class="va">s.prots</span>, <span class="va">s.amines</span><span class="op">)</span></span>
<span><span class="va">Z.ml</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SparseSpearmanCor2.html">SparseSpearmanCor2</a></span><span class="op">(</span><span class="va">s.primary</span>, <span class="va">s.lipid</span><span class="op">)</span></span>
<span><span class="va">Z.ma</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SparseSpearmanCor2.html">SparseSpearmanCor2</a></span><span class="op">(</span><span class="va">s.primary</span>, <span class="va">s.amines</span><span class="op">)</span></span>
<span><span class="va">Z.la</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SparseSpearmanCor2.html">SparseSpearmanCor2</a></span><span class="op">(</span><span class="va">s.lipid</span>, <span class="va">s.amines</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add row and column names to each dataframe</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">Z.pp</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">all_df</span><span class="op">[</span>,<span class="va">cat.prots</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">all_df</span><span class="op">[</span>,<span class="va">cat.prots</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">Z.mm</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">all_df</span><span class="op">[</span>,<span class="va">cat.primary</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">all_df</span><span class="op">[</span>,<span class="va">cat.primary</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">Z.ll</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">all_df</span><span class="op">[</span>,<span class="va">cat.lipid</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">all_df</span><span class="op">[</span>,<span class="va">cat.lipid</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">Z.aa</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">all_df</span><span class="op">[</span>,<span class="va">cat.amines</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">all_df</span><span class="op">[</span>,<span class="va">cat.amines</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">Z.pm</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">all_df</span><span class="op">[</span>,<span class="va">cat.prots</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">all_df</span><span class="op">[</span>,<span class="va">cat.primary</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">Z.pl</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">all_df</span><span class="op">[</span>,<span class="va">cat.prots</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">all_df</span><span class="op">[</span>,<span class="va">cat.lipid</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">Z.pa</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">all_df</span><span class="op">[</span>,<span class="va">cat.prots</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">all_df</span><span class="op">[</span>,<span class="va">cat.amines</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">Z.ml</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">all_df</span><span class="op">[</span>,<span class="va">cat.primary</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">all_df</span><span class="op">[</span>,<span class="va">cat.lipid</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">Z.ma</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">all_df</span><span class="op">[</span>,<span class="va">cat.primary</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">all_df</span><span class="op">[</span>,<span class="va">cat.amines</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">Z.la</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">all_df</span><span class="op">[</span>,<span class="va">cat.lipid</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">all_df</span><span class="op">[</span>,<span class="va">cat.amines</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="within-category-standarized-distributions">Within-category standarized distributions<a class="anchor" aria-label="anchor" href="#within-category-standarized-distributions"></a>
</h4>
<p>Below we use the standardcor functions to estimate a Beta parameters
from mean and std dev for each omic.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### Protein Protein</span></span>
<span><span class="va">Z.unique</span> <span class="op">&lt;-</span> <span class="va">Z.pp</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/row.html" class="external-link">row</a></span><span class="op">(</span><span class="va">Z.pp</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fu"><a href="https://rdrr.io/r/base/col.html" class="external-link">col</a></span><span class="op">(</span><span class="va">Z.pp</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">vw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimateShape.html">estimateShape</a></span><span class="op">(</span><span class="va">Z.pp</span><span class="op">)</span></span>
<span><span class="va">v.pp</span> <span class="op">&lt;-</span> <span class="va">vw</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">w.pp</span> <span class="op">&lt;-</span> <span class="va">vw</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Protein pairs: rho_ij ~ Beta(v ="</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">v.pp</span>,<span class="fl">3</span><span class="op">)</span>,<span class="st">",w ="</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">w.pp</span>,<span class="fl">3</span><span class="op">)</span>,<span class="st">")"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Protein pairs: rho_ij ~ Beta(v = 34.98 ,w = 34.002 )"</span></span>
<span></span>
<span><span class="va">fine</span> <span class="op">&lt;-</span> <span class="fl">40</span></span>
<span><span class="va">Bs</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">fine</span><span class="op">:</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">fine</span><span class="op">)</span><span class="op">)</span><span class="op">-</span><span class="fl">0.5</span><span class="op">)</span><span class="op">/</span><span class="va">fine</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">Z.unique</span>, breaks<span class="op">=</span><span class="va">Bs</span>, xlab<span class="op">=</span><span class="st">"Correlation"</span>, ylab<span class="op">=</span><span class="st">"Density"</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">4</span><span class="op">)</span>,</span>
<span>     main<span class="op">=</span><span class="st">"Pairwise protein correlations"</span>, prob<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/box.html" class="external-link">box</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span>,lty<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">fine</span><span class="op">:</span><span class="va">fine</span><span class="op">)</span><span class="op">/</span><span class="va">fine</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">r</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">dbeta</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">r</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>, <span class="va">v.pp</span>, <span class="va">w.pp</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>, lwd<span class="op">=</span><span class="fl">3</span>, col<span class="op">=</span><span class="st">"MediumBlue"</span><span class="op">)</span></span></code></pre></div>
<p><img src="standardcor-WGCNA_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<p>The blue line shows the model distrubtion. We can see it fits the
background distribution. We will repeat this process for all other
omics</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### Metabolite-Metabolite</span></span>
<span><span class="va">Z.unique</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">Z.mm</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/row.html" class="external-link">row</a></span><span class="op">(</span><span class="va">Z.mm</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fu"><a href="https://rdrr.io/r/base/col.html" class="external-link">col</a></span><span class="op">(</span><span class="va">Z.mm</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">vw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimateShape.html">estimateShape</a></span><span class="op">(</span><span class="va">Z.mm</span><span class="op">)</span></span>
<span><span class="va">v.mm</span> <span class="op">&lt;-</span> <span class="va">vw</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">w.mm</span> <span class="op">&lt;-</span> <span class="va">vw</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Metabolite Pairs: rho_ij ~ Beta(v ="</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">v.mm</span>,<span class="fl">3</span><span class="op">)</span>,<span class="st">",w ="</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">w.mm</span>,<span class="fl">3</span><span class="op">)</span>,<span class="st">")"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Metabolite Pairs: rho_ij ~ Beta(v = 98.489 ,w = 98.706 )"</span></span>
<span></span>
<span><span class="va">fine</span> <span class="op">&lt;-</span> <span class="fl">40</span></span>
<span><span class="va">Bs</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">fine</span><span class="op">:</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">fine</span><span class="op">)</span><span class="op">)</span><span class="op">-</span><span class="fl">0.5</span><span class="op">)</span><span class="op">/</span><span class="va">fine</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">Z.unique</span>, breaks<span class="op">=</span><span class="va">Bs</span>, xlab<span class="op">=</span><span class="st">"Correlation"</span>, ylab<span class="op">=</span><span class="st">"Density"</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">7.5</span><span class="op">)</span>,</span>
<span>     main<span class="op">=</span><span class="st">"Pairwise primary metabolite correlations"</span>, prob<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/box.html" class="external-link">box</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span>,lty<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">fine</span><span class="op">:</span><span class="va">fine</span><span class="op">)</span><span class="op">/</span><span class="va">fine</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">r</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">dbeta</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">r</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>, <span class="va">v.mm</span>, <span class="va">w.mm</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>, lwd<span class="op">=</span><span class="fl">3</span>, col<span class="op">=</span><span class="st">"MediumBlue"</span><span class="op">)</span></span></code></pre></div>
<p><img src="standardcor-WGCNA_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### Lipid - Lipid</span></span>
<span><span class="va">Z.unique</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">Z.ll</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/row.html" class="external-link">row</a></span><span class="op">(</span><span class="va">Z.ll</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fu"><a href="https://rdrr.io/r/base/col.html" class="external-link">col</a></span><span class="op">(</span><span class="va">Z.ll</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">vw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimateShape.html">estimateShape</a></span><span class="op">(</span><span class="va">Z.ll</span><span class="op">)</span></span>
<span><span class="va">v.ll</span> <span class="op">&lt;-</span> <span class="va">vw</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">w.ll</span> <span class="op">&lt;-</span> <span class="va">vw</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Lipid Pairs: rho_ij ~ Beta(v ="</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">v.ll</span>,<span class="fl">3</span><span class="op">)</span>,<span class="st">",w ="</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">w.ll</span>,<span class="fl">3</span><span class="op">)</span>,<span class="st">")"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Lipid Pairs: rho_ij ~ Beta(v = 27.938 ,w = 25.131 )"</span></span>
<span></span>
<span><span class="va">fine</span> <span class="op">&lt;-</span> <span class="fl">40</span></span>
<span><span class="va">Bs</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">fine</span><span class="op">:</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">fine</span><span class="op">)</span><span class="op">)</span><span class="op">-</span><span class="fl">0.5</span><span class="op">)</span><span class="op">/</span><span class="va">fine</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">Z.unique</span>, breaks<span class="op">=</span><span class="va">Bs</span>, xlab<span class="op">=</span><span class="st">"Correlation"</span>, ylab<span class="op">=</span><span class="st">"Density"</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">7.5</span><span class="op">)</span>,</span>
<span>     main<span class="op">=</span><span class="st">"Pairwise lipid correlations"</span>, prob<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/box.html" class="external-link">box</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span>,lty<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">fine</span><span class="op">:</span><span class="va">fine</span><span class="op">)</span><span class="op">/</span><span class="va">fine</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">r</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">dbeta</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">r</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>, <span class="va">v.ll</span>, <span class="va">w.ll</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>, lwd<span class="op">=</span><span class="fl">3</span>, col<span class="op">=</span><span class="st">"MediumBlue"</span><span class="op">)</span></span></code></pre></div>
<p><img src="standardcor-WGCNA_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### Amine - Amine</span></span>
<span><span class="va">Z.unique</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">Z.aa</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/row.html" class="external-link">row</a></span><span class="op">(</span><span class="va">Z.aa</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fu"><a href="https://rdrr.io/r/base/col.html" class="external-link">col</a></span><span class="op">(</span><span class="va">Z.aa</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">vw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimateShape.html">estimateShape</a></span><span class="op">(</span><span class="va">Z.aa</span><span class="op">)</span></span>
<span><span class="va">v.aa</span> <span class="op">&lt;-</span> <span class="va">vw</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">w.aa</span> <span class="op">&lt;-</span> <span class="va">vw</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Amine Pairs: rho_ij ~ Beta(v ="</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">vw</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="fl">3</span><span class="op">)</span>,<span class="st">",w ="</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">vw</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="fl">3</span><span class="op">)</span>,<span class="st">")"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Amine Pairs: rho_ij ~ Beta(v = 112.787 ,w = 109.907 )"</span></span>
<span></span>
<span><span class="va">fine</span> <span class="op">&lt;-</span> <span class="fl">40</span></span>
<span><span class="va">Bs</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">fine</span><span class="op">:</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">fine</span><span class="op">)</span><span class="op">)</span><span class="op">-</span><span class="fl">0.5</span><span class="op">)</span><span class="op">/</span><span class="va">fine</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">Z.unique</span>, breaks<span class="op">=</span><span class="va">Bs</span>, xlab<span class="op">=</span><span class="st">"Correlation"</span>, ylab<span class="op">=</span><span class="st">"Density"</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">7.5</span><span class="op">)</span>,</span>
<span>     main<span class="op">=</span><span class="st">"Pairwise amine correlations"</span>, prob<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/box.html" class="external-link">box</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span>,lty<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">fine</span><span class="op">:</span><span class="va">fine</span><span class="op">)</span><span class="op">/</span><span class="va">fine</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">r</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">dbeta</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">r</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>, <span class="va">vw</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">vw</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>, lwd<span class="op">=</span><span class="fl">3</span>, col<span class="op">=</span><span class="st">"MediumBlue"</span><span class="op">)</span></span></code></pre></div>
<p><img src="standardcor-WGCNA_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="cross-category">Cross-category<a class="anchor" aria-label="anchor" href="#cross-category"></a>
</h2>
<p>We continue the same process for each of the cross-category omics
combinations. consider.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">Z.pm</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 283 149</span></span>
<span><span class="va">Z.unique</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">Z.pm</span><span class="op">)</span> <span class="co"># there are no self-comparisons, nor are there repeats due to symmetry</span></span>
<span><span class="va">vw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimateShape.html">estimateShape</a></span><span class="op">(</span><span class="va">Z.pm</span><span class="op">)</span></span>
<span><span class="va">v.pm</span> <span class="op">&lt;-</span> <span class="va">vw</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">w.pm</span> <span class="op">&lt;-</span> <span class="va">vw</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Protein-metabolite: rho_ij ~ Beta(v ="</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">vw</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="fl">3</span><span class="op">)</span>,<span class="st">",w ="</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">vw</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="fl">3</span><span class="op">)</span>,<span class="st">")"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Protein-metabolite: rho_ij ~ Beta(v = 174.852 ,w = 173.513 )"</span></span>
<span></span>
<span><span class="co"># The distribution of these cross-correlations is</span></span>
<span><span class="co"># markedly narrower than either of the contributing 'omics</span></span>
<span><span class="va">fine</span> <span class="op">&lt;-</span> <span class="fl">40</span></span>
<span><span class="va">Bs</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">fine</span><span class="op">:</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">fine</span><span class="op">)</span><span class="op">)</span><span class="op">-</span><span class="fl">0.5</span><span class="op">)</span><span class="op">/</span><span class="va">fine</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">Z.unique</span>, breaks<span class="op">=</span><span class="va">Bs</span>, xlab<span class="op">=</span><span class="st">"Correlation"</span>, ylab<span class="op">=</span><span class="st">"Density"</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">7.5</span><span class="op">)</span>,</span>
<span>     main<span class="op">=</span><span class="st">"Pairwise Protein-metabolite correlations"</span>, prob<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/box.html" class="external-link">box</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span>,lty<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">fine</span><span class="op">:</span><span class="va">fine</span><span class="op">)</span><span class="op">/</span><span class="va">fine</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">r</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">dbeta</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">r</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>, <span class="va">vw</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">vw</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>, lwd<span class="op">=</span><span class="fl">3</span>, col<span class="op">=</span><span class="st">"MediumBlue"</span><span class="op">)</span></span></code></pre></div>
<p><img src="standardcor-WGCNA_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Modeling cross-category correlations: protein-lipid</span></span>
<span><span class="va">Z.unique</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">Z.pl</span><span class="op">)</span> <span class="co"># there are no self-comparisons, nor are there repeats due to symmetry</span></span>
<span><span class="va">vw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimateShape.html">estimateShape</a></span><span class="op">(</span><span class="va">Z.pl</span><span class="op">)</span></span>
<span><span class="va">v.pl</span> <span class="op">&lt;-</span> <span class="va">vw</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">w.pl</span> <span class="op">&lt;-</span> <span class="va">vw</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Protein-metabolite: rho_ij ~ Beta(v ="</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">vw</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="fl">3</span><span class="op">)</span>,<span class="st">",w ="</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">vw</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="fl">3</span><span class="op">)</span>,<span class="st">")"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Protein-metabolite: rho_ij ~ Beta(v = 87.319 ,w = 89.012 )"</span></span>
<span></span>
<span><span class="co"># The distribution of these cross-correlations is</span></span>
<span><span class="co"># markedly narrower than either of the contributing 'omics</span></span>
<span><span class="va">fine</span> <span class="op">&lt;-</span> <span class="fl">40</span></span>
<span><span class="va">Bs</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">fine</span><span class="op">:</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">fine</span><span class="op">)</span><span class="op">)</span><span class="op">-</span><span class="fl">0.5</span><span class="op">)</span><span class="op">/</span><span class="va">fine</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">Z.unique</span>, breaks<span class="op">=</span><span class="va">Bs</span>, xlab<span class="op">=</span><span class="st">"Correlation"</span>, ylab<span class="op">=</span><span class="st">"Density"</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">7.5</span><span class="op">)</span>,</span>
<span>     main<span class="op">=</span><span class="st">"Pairwise Protein-metabolite correlations"</span>, prob<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/box.html" class="external-link">box</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span>,lty<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">fine</span><span class="op">:</span><span class="va">fine</span><span class="op">)</span><span class="op">/</span><span class="va">fine</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">r</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">dbeta</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">r</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>, <span class="va">vw</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">vw</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>, lwd<span class="op">=</span><span class="fl">3</span>, col<span class="op">=</span><span class="st">"MediumBlue"</span><span class="op">)</span></span></code></pre></div>
<p><img src="standardcor-WGCNA_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Modeling cross-category correlations: protein-amine</span></span>
<span><span class="va">Z.unique</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">Z.pa</span><span class="op">)</span> <span class="co"># there are no self-comparisons, nor are there repeats due to symmetry</span></span>
<span><span class="va">vw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimateShape.html">estimateShape</a></span><span class="op">(</span><span class="va">Z.pa</span><span class="op">)</span></span>
<span><span class="va">v.pa</span> <span class="op">&lt;-</span> <span class="va">vw</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">w.pa</span> <span class="op">&lt;-</span> <span class="va">vw</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Protein-metabolite: rho_ij ~ Beta(v ="</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">vw</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="fl">3</span><span class="op">)</span>,<span class="st">",w ="</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">vw</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="fl">3</span><span class="op">)</span>,<span class="st">")"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Protein-metabolite: rho_ij ~ Beta(v = 136.503 ,w = 136.271 )"</span></span>
<span></span>
<span><span class="co"># The distribution of these cross-correlations is</span></span>
<span><span class="co"># markedly narrower than either of the contributing 'omics</span></span>
<span><span class="va">fine</span> <span class="op">&lt;-</span> <span class="fl">40</span></span>
<span><span class="va">Bs</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">fine</span><span class="op">:</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">fine</span><span class="op">)</span><span class="op">)</span><span class="op">-</span><span class="fl">0.5</span><span class="op">)</span><span class="op">/</span><span class="va">fine</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">Z.unique</span>, breaks<span class="op">=</span><span class="va">Bs</span>, xlab<span class="op">=</span><span class="st">"Correlation"</span>, ylab<span class="op">=</span><span class="st">"Density"</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">7.5</span><span class="op">)</span>,</span>
<span>     main<span class="op">=</span><span class="st">"Pairwise Protein-metabolite correlations"</span>, prob<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/box.html" class="external-link">box</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span>,lty<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">fine</span><span class="op">:</span><span class="va">fine</span><span class="op">)</span><span class="op">/</span><span class="va">fine</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">r</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">dbeta</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">r</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>, <span class="va">vw</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">vw</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>, lwd<span class="op">=</span><span class="fl">3</span>, col<span class="op">=</span><span class="st">"MediumBlue"</span><span class="op">)</span></span></code></pre></div>
<p><img src="standardcor-WGCNA_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Modeling cross-category correlations: primary-lipid</span></span>
<span><span class="va">Z.unique</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">Z.ml</span><span class="op">)</span> <span class="co"># there are no self-comparisons, nor are there repeats due to symmetry</span></span>
<span><span class="va">vw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimateShape.html">estimateShape</a></span><span class="op">(</span><span class="va">Z.ml</span><span class="op">)</span></span>
<span><span class="va">v.ml</span> <span class="op">&lt;-</span> <span class="va">vw</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">w.ml</span> <span class="op">&lt;-</span> <span class="va">vw</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Protein-lipid: rho_ij ~ Beta(v ="</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">vw</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="fl">3</span><span class="op">)</span>,<span class="st">",w ="</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">vw</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="fl">3</span><span class="op">)</span>,<span class="st">")"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Protein-lipid: rho_ij ~ Beta(v = 184.501 ,w = 185.53 )"</span></span>
<span></span>
<span><span class="co"># The distribution of these cross-correlations is</span></span>
<span><span class="co"># markedly narrower than either of the contributing 'omics</span></span>
<span><span class="va">fine</span> <span class="op">&lt;-</span> <span class="fl">40</span></span>
<span><span class="va">Bs</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">fine</span><span class="op">:</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">fine</span><span class="op">)</span><span class="op">)</span><span class="op">-</span><span class="fl">0.5</span><span class="op">)</span><span class="op">/</span><span class="va">fine</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">Z.unique</span>, breaks<span class="op">=</span><span class="va">Bs</span>, xlab<span class="op">=</span><span class="st">"Correlation"</span>, ylab<span class="op">=</span><span class="st">"Density"</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">7.5</span><span class="op">)</span>,</span>
<span>     main<span class="op">=</span><span class="st">"Pairwise Protein-lipid correlations"</span>, prob<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/box.html" class="external-link">box</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span>,lty<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">fine</span><span class="op">:</span><span class="va">fine</span><span class="op">)</span><span class="op">/</span><span class="va">fine</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">r</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">dbeta</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">r</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>, <span class="va">vw</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">vw</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>, lwd<span class="op">=</span><span class="fl">3</span>, col<span class="op">=</span><span class="st">"MediumBlue"</span><span class="op">)</span></span></code></pre></div>
<p><img src="standardcor-WGCNA_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Modeling cross-category correlations: primary-amine</span></span>
<span><span class="va">Z.unique</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">Z.ma</span><span class="op">)</span> <span class="co"># there are no self-comparisons, nor are there repeats due to symmetry</span></span>
<span><span class="va">vw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimateShape.html">estimateShape</a></span><span class="op">(</span><span class="va">Z.ma</span><span class="op">)</span></span>
<span><span class="va">v.ma</span> <span class="op">&lt;-</span> <span class="va">vw</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">w.ma</span> <span class="op">&lt;-</span> <span class="va">vw</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Protein-amine: rho_ij ~ Beta(v ="</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">vw</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="fl">3</span><span class="op">)</span>,<span class="st">",w ="</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">vw</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="fl">3</span><span class="op">)</span>,<span class="st">")"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Protein-amine: rho_ij ~ Beta(v = 184.687 ,w = 184.458 )"</span></span>
<span></span>
<span><span class="co"># The distribution of these cross-correlations is</span></span>
<span><span class="co"># markedly narrower than either of the contributing 'omics</span></span>
<span><span class="va">fine</span> <span class="op">&lt;-</span> <span class="fl">40</span></span>
<span><span class="va">Bs</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">fine</span><span class="op">:</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">fine</span><span class="op">)</span><span class="op">)</span><span class="op">-</span><span class="fl">0.5</span><span class="op">)</span><span class="op">/</span><span class="va">fine</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">Z.unique</span>, breaks<span class="op">=</span><span class="va">Bs</span>, xlab<span class="op">=</span><span class="st">"Correlation"</span>, ylab<span class="op">=</span><span class="st">"Density"</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">7.5</span><span class="op">)</span>,</span>
<span>     main<span class="op">=</span><span class="st">"Pairwise Protein-amine correlations"</span>, prob<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/box.html" class="external-link">box</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span>,lty<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">fine</span><span class="op">:</span><span class="va">fine</span><span class="op">)</span><span class="op">/</span><span class="va">fine</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">r</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">dbeta</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">r</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>, <span class="va">vw</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">vw</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>, lwd<span class="op">=</span><span class="fl">3</span>, col<span class="op">=</span><span class="st">"MediumBlue"</span><span class="op">)</span></span></code></pre></div>
<p><img src="standardcor-WGCNA_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Modeling cross-category correlations: lipid-amine</span></span>
<span><span class="va">Z.unique</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">Z.la</span><span class="op">)</span> <span class="co"># there are no self-comparisons, nor are there repeats due to symmetry</span></span>
<span><span class="va">vw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimateShape.html">estimateShape</a></span><span class="op">(</span><span class="va">Z.la</span><span class="op">)</span></span>
<span><span class="va">v.la</span> <span class="op">&lt;-</span> <span class="va">vw</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">w.la</span> <span class="op">&lt;-</span> <span class="va">vw</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Lipid-amine: rho_ij ~ Beta(v ="</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">vw</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="fl">3</span><span class="op">)</span>,<span class="st">",w ="</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">vw</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="fl">3</span><span class="op">)</span>,<span class="st">")"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Lipid-amine: rho_ij ~ Beta(v = 125.539 ,w = 125.208 )"</span></span>
<span></span>
<span><span class="co"># The distribution of these cross-correlations is</span></span>
<span><span class="co"># markedly narrower than either of the contributing 'omics</span></span>
<span><span class="va">fine</span> <span class="op">&lt;-</span> <span class="fl">40</span></span>
<span><span class="va">Bs</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">fine</span><span class="op">:</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">fine</span><span class="op">)</span><span class="op">)</span><span class="op">-</span><span class="fl">0.5</span><span class="op">)</span><span class="op">/</span><span class="va">fine</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">Z.unique</span>, breaks<span class="op">=</span><span class="va">Bs</span>, xlab<span class="op">=</span><span class="st">"Correlation"</span>, ylab<span class="op">=</span><span class="st">"Density"</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">7.5</span><span class="op">)</span>,</span>
<span>     main<span class="op">=</span><span class="st">"Pairwise lipid-amine correlations"</span>, prob<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/box.html" class="external-link">box</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span>,lty<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">fine</span><span class="op">:</span><span class="va">fine</span><span class="op">)</span><span class="op">/</span><span class="va">fine</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">r</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">dbeta</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">r</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>, <span class="va">vw</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">vw</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>, lwd<span class="op">=</span><span class="fl">3</span>, col<span class="op">=</span><span class="st">"MediumBlue"</span><span class="op">)</span></span></code></pre></div>
<p><img src="standardcor-WGCNA_files/figure-html/unnamed-chunk-19-1.png" width="700"></p>
<div class="section level3">
<h3 id="merging-correlations-from-disparate-data-subsets">Merging correlations from disparate data subsets<a class="anchor" aria-label="anchor" href="#merging-correlations-from-disparate-data-subsets"></a>
</h3>
<p>This centering process is similar to, but not the same as “quantile
normalization”. In quantile normalization, each value
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mi>i</mi></msub><annotation encoding="application/x-tex">x_i</annotation></semantics></math>
in the observed data has a cumulative probability
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>i</mi></msub><mo>=</mo><mo>Pr</mo><mrow><mo stretchy="false" form="prefix">{</mo><mi>x</mi><mo>&lt;</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false" form="postfix">}</mo></mrow></mrow><annotation encoding="application/x-tex">p_i = \Pr{\{x &lt; x_i\} }</annotation></semantics></math>
among the observed data
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><mi>x</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{ x \}</annotation></semantics></math>
which, accounting for the possibility of ties in a finite dataset, is
the average rank of all observed values equal to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mi>i</mi></msub><annotation encoding="application/x-tex">x_i</annotation></semantics></math>
divided by the total number of observed values. The value
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mi>i</mi></msub><annotation encoding="application/x-tex">x_i</annotation></semantics></math>
is then transformed to the value
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>q</mi><mi>i</mi></msub><annotation encoding="application/x-tex">q_i</annotation></semantics></math>
with cumulative probability
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mi>i</mi></msub><annotation encoding="application/x-tex">p_i</annotation></semantics></math>
according to a normalizing probability distribution
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>D</mi><annotation encoding="application/x-tex">D</annotation></semantics></math>
(i.e. <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>Pr</mo><mrow><mo stretchy="false" form="prefix">{</mo><mi>d</mi><mo>&lt;</mo><msub><mi>q</mi><mi>i</mi></msub><mo stretchy="false" form="prefix">|</mo><mi>D</mi><mo stretchy="false" form="postfix">}</mo></mrow><mo>=</mo><msub><mi>p</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\Pr{ \{ d &lt; q_i | D \} } = p_i</annotation></semantics></math>).</p>
<p>In this centering process, rather than using the rank of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mi>i</mi></msub><annotation encoding="application/x-tex">x_i</annotation></semantics></math>
in the observed data, we use a null model of the observed data;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mi>i</mi></msub><annotation encoding="application/x-tex">p_i</annotation></semantics></math>
is therefore a <strong>p-value</strong> for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mi>i</mi></msub><annotation encoding="application/x-tex">x_i</annotation></semantics></math>
under the null model, and the transformed value
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>q</mi><mi>i</mi></msub><annotation encoding="application/x-tex">q_i</annotation></semantics></math>
has the same significance under the normalized probability distribution
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>D</mi><annotation encoding="application/x-tex">D</annotation></semantics></math>
as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mi>i</mi></msub><annotation encoding="application/x-tex">x_i</annotation></semantics></math>
had in the original null distribution. This allows us to merge datasets
while retaining the significance they had in their original cohort. Only
when the empirical distribution is used as the null model are these two
processes the same.</p>
<p>Here, we use a beta distribution as a null model precisely because
the appropriate null model for correlations of arbitrary independent
vectors is, under some reasonable assumptions, indistinguishable from a
Beta distribution. We believe this is a more appropriate null model of
correlations, and suggest that the primary effect of this null model is
to account for the effective number of dimensions in the observed data,
prior to using a 2D geometric model to compute correlations between the
observations.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nu.std</span> <span class="op">&lt;-</span> <span class="fl">34</span> <span class="co"># As wide as the widest compoonent, and centered at 0</span></span>
<span></span>
<span><span class="va">Zc.pp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/centerBeta.html">centerBeta</a></span><span class="op">(</span><span class="va">Z.pp</span>, <span class="va">v.pp</span>, <span class="va">w.pp</span>, <span class="va">nu.std</span><span class="op">)</span></span>
<span><span class="va">Zc.mm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/centerBeta.html">centerBeta</a></span><span class="op">(</span><span class="va">Z.mm</span>, <span class="va">v.mm</span>, <span class="va">w.mm</span>, <span class="va">nu.std</span><span class="op">)</span></span>
<span><span class="va">Zc.ll</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/centerBeta.html">centerBeta</a></span><span class="op">(</span><span class="va">Z.ll</span>, <span class="va">v.ll</span>, <span class="va">w.ll</span>, <span class="va">nu.std</span><span class="op">)</span></span>
<span><span class="va">Zc.aa</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/centerBeta.html">centerBeta</a></span><span class="op">(</span><span class="va">Z.aa</span>, <span class="va">v.aa</span>, <span class="va">w.aa</span>, <span class="va">nu.std</span><span class="op">)</span></span>
<span><span class="va">Zc.pm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/centerBeta.html">centerBeta</a></span><span class="op">(</span><span class="va">Z.pm</span>, <span class="va">v.pm</span>, <span class="va">w.pm</span>, <span class="va">nu.std</span><span class="op">)</span></span>
<span><span class="va">Zc.pl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/centerBeta.html">centerBeta</a></span><span class="op">(</span><span class="va">Z.pl</span>, <span class="va">v.pl</span>, <span class="va">w.pl</span>, <span class="va">nu.std</span><span class="op">)</span></span>
<span><span class="va">Zc.pa</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/centerBeta.html">centerBeta</a></span><span class="op">(</span><span class="va">Z.pa</span>, <span class="va">v.pa</span>, <span class="va">w.pa</span>, <span class="va">nu.std</span><span class="op">)</span></span>
<span><span class="va">Zc.ml</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/centerBeta.html">centerBeta</a></span><span class="op">(</span><span class="va">Z.ml</span>, <span class="va">v.ml</span>, <span class="va">w.ml</span>, <span class="va">nu.std</span><span class="op">)</span></span>
<span><span class="va">Zc.ma</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/centerBeta.html">centerBeta</a></span><span class="op">(</span><span class="va">Z.ma</span>, <span class="va">v.ma</span>, <span class="va">w.ma</span>, <span class="va">nu.std</span><span class="op">)</span></span>
<span><span class="va">Zc.la</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/centerBeta.html">centerBeta</a></span><span class="op">(</span><span class="va">Z.la</span>, <span class="va">v.la</span>, <span class="va">w.la</span>, <span class="va">nu.std</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Combined, centered correlations</span></span>
<span></span>
<span><span class="va">Zc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">all.analytes</span><span class="op">)</span>,</span>
<span>             ncol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">all.analytes</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">Zc</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">all.analytes</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">Zc</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">all.analytes</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### Construct a final dataframe that contains all the correlation values.</span></span>
<span><span class="co">###</span></span>
<span><span class="co"># Block-structured correlation matrix</span></span>
<span><span class="co"># Zc = [ PP     PM   PL  PA  |</span></span>
<span><span class="co">#      | PM^T   MM   ML   MA |</span></span>
<span><span class="co">#      | PL^T  MC^T  LL  LA  |</span></span>
<span><span class="co">#      | PA^T  MA^T  LA^T AA ]</span></span>
<span><span class="co">###</span></span>
<span><span class="va">Zc</span><span class="op">[</span><span class="va">cat.prots</span>, <span class="va">cat.prots</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">Zc.pp</span></span>
<span><span class="va">Zc</span><span class="op">[</span><span class="va">cat.primary</span>,  <span class="va">cat.primary</span><span class="op">]</span>  <span class="op">&lt;-</span> <span class="va">Zc.mm</span></span>
<span><span class="va">Zc</span><span class="op">[</span><span class="va">cat.lipid</span>,  <span class="va">cat.lipid</span><span class="op">]</span>  <span class="op">&lt;-</span> <span class="va">Zc.ll</span></span>
<span><span class="va">Zc</span><span class="op">[</span><span class="va">cat.amines</span>,  <span class="va">cat.amines</span><span class="op">]</span>  <span class="op">&lt;-</span> <span class="va">Zc.aa</span></span>
<span></span>
<span><span class="va">Zc</span><span class="op">[</span><span class="va">cat.prots</span>, <span class="va">cat.primary</span><span class="op">]</span>  <span class="op">&lt;-</span> <span class="va">Zc.pm</span></span>
<span><span class="va">Zc</span><span class="op">[</span><span class="va">cat.primary</span>, <span class="va">cat.prots</span><span class="op">]</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">Zc.pm</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Zc</span><span class="op">[</span><span class="va">cat.prots</span>, <span class="va">cat.lipid</span><span class="op">]</span>  <span class="op">&lt;-</span> <span class="va">Zc.pl</span></span>
<span><span class="va">Zc</span><span class="op">[</span><span class="va">cat.lipid</span>, <span class="va">cat.prots</span><span class="op">]</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">Zc.pl</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Zc</span><span class="op">[</span><span class="va">cat.prots</span>, <span class="va">cat.amines</span><span class="op">]</span>  <span class="op">&lt;-</span> <span class="va">Zc.pa</span></span>
<span><span class="va">Zc</span><span class="op">[</span><span class="va">cat.amines</span>, <span class="va">cat.prots</span><span class="op">]</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">Zc.pa</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Zc</span><span class="op">[</span><span class="va">cat.primary</span>, <span class="va">cat.lipid</span><span class="op">]</span>  <span class="op">&lt;-</span> <span class="va">Zc.ml</span></span>
<span><span class="va">Zc</span><span class="op">[</span><span class="va">cat.lipid</span>, <span class="va">cat.primary</span><span class="op">]</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">Zc.ml</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Zc</span><span class="op">[</span><span class="va">cat.primary</span>, <span class="va">cat.amines</span><span class="op">]</span>  <span class="op">&lt;-</span> <span class="va">Zc.ma</span></span>
<span><span class="va">Zc</span><span class="op">[</span><span class="va">cat.amines</span>, <span class="va">cat.primary</span><span class="op">]</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">Zc.ma</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Zc</span><span class="op">[</span><span class="va">cat.lipid</span>, <span class="va">cat.amines</span><span class="op">]</span>  <span class="op">&lt;-</span> <span class="va">Zc.la</span></span>
<span><span class="va">Zc</span><span class="op">[</span><span class="va">cat.amines</span>, <span class="va">cat.lipid</span><span class="op">]</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">Zc.la</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_c.html" class="external-link">str_c</a></span><span class="op">(</span><span class="st">"nrow: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Zc</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "nrow: 1465"</span></span>
<span><span class="va">Zc</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span><span class="co">#&gt;              1433Z        A1AG2        A1AT         A1BG        A2AP</span></span>
<span><span class="co">#&gt; 1433Z  1.000000000  0.005707413  0.02901604 -0.006209182 -0.28999711</span></span>
<span><span class="co">#&gt; A1AG2  0.005707413  1.000000000  0.12406421  0.087104661 -0.17529426</span></span>
<span><span class="co">#&gt; A1AT   0.029016044  0.124064205  1.00000000  0.101222530 -0.29220877</span></span>
<span><span class="co">#&gt; A1BG  -0.006209182  0.087104661  0.10122253  1.000000000 -0.03940435</span></span>
<span><span class="co">#&gt; A2AP  -0.289997110 -0.175294264 -0.29220877 -0.039404352  1.00000000</span></span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Z.unique</span> <span class="op">&lt;-</span> <span class="va">Zc</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/row.html" class="external-link">row</a></span><span class="op">(</span><span class="va">Zc</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fu"><a href="https://rdrr.io/r/base/col.html" class="external-link">col</a></span><span class="op">(</span><span class="va">Zc</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Target: rho_ij ~ Beta(v ="</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">nu.std</span>,<span class="fl">3</span><span class="op">)</span>,<span class="st">",w ="</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">nu.std</span>,<span class="fl">3</span><span class="op">)</span>,<span class="st">")"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Target: rho_ij ~ Beta(v = 34 ,w = 34 )"</span></span>
<span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">Z.unique</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span></span>
<span><span class="va">mZ</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="va">s2Z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="va">v.c</span> <span class="op">&lt;-</span> <span class="va">mZ</span><span class="op">*</span><span class="op">(</span><span class="va">mZ</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">mZ</span><span class="op">)</span><span class="op">/</span><span class="va">s2Z</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">w.c</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">mZ</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">mZ</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">mZ</span><span class="op">)</span><span class="op">/</span><span class="va">s2Z</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Method of moments: rho_ij ~ Beta(v ="</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">v.c</span>,<span class="fl">3</span><span class="op">)</span>,<span class="st">",w ="</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">w.c</span>,<span class="fl">3</span><span class="op">)</span>,<span class="st">")"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Method of moments: rho_ij ~ Beta(v = 22.515 ,w = 21.686 )"</span></span>
<span></span>
<span></span>
<span><span class="va">fine</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">Zc.unique</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">Zc</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/row.html" class="external-link">row</a></span><span class="op">(</span><span class="va">Zc</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fu"><a href="https://rdrr.io/r/base/col.html" class="external-link">col</a></span><span class="op">(</span><span class="va">Zc</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">Bs</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">fine</span><span class="op">:</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">fine</span><span class="op">)</span><span class="op">)</span><span class="op">-</span><span class="fl">0.5</span><span class="op">)</span><span class="op">/</span><span class="va">fine</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">Zc.unique</span>, breaks<span class="op">=</span><span class="va">Bs</span>, xlab<span class="op">=</span><span class="st">"Correlation"</span>, ylab<span class="op">=</span><span class="st">"Density"</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">5</span><span class="op">)</span>,</span>
<span>     main<span class="op">=</span><span class="st">"All pairwise correlations, centered"</span>, prob<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/box.html" class="external-link">box</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span>,lty<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">fine</span><span class="op">:</span><span class="va">fine</span><span class="op">)</span><span class="op">/</span><span class="va">fine</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">r</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">dbeta</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">r</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>, <span class="va">nu.std</span>, <span class="va">nu.std</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>, lwd<span class="op">=</span><span class="fl">3</span>, col<span class="op">=</span><span class="st">"orangered"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">r</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">dbeta</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">r</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>, <span class="va">v.c</span>, <span class="va">w.c</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>, lwd<span class="op">=</span><span class="fl">3</span>, col<span class="op">=</span><span class="st">"MediumBlue"</span><span class="op">)</span></span></code></pre></div>
<p><img src="standardcor-WGCNA_files/figure-html/unnamed-chunk-23-1.png" width="700"></p>
<p>These are now standardized correlations. The mean and variance of
this distribution suggest a model (shown in blue) that fits less well
than the standardizing model (in orange); this is a consequence of the
differences between the models we fitted and the empirical
distributions, and indicates that the enrichment of high correlations we
observed in the individual ’omics distributions has been preserved. If
we had used quantile normalization, the overabundance of high
correlations would have been shifted to lower correlation values, and
the fitted blue model would be identical to the standardizing model.</p>
</div>
</div>
<div class="section level2">
<h2 id="wgcna">WGCNA<a class="anchor" aria-label="anchor" href="#wgcna"></a>
</h2>
<p>The code below follows a standard WGCNA analysis. More information
can be found here: <a href="https://peterlangfelder.com/2018/11/25/wgcna-resources-on-the-web/" class="external-link uri">https://peterlangfelder.com/2018/11/25/wgcna-resources-on-the-web/</a></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Manually convert the pairwise correlation DF to the signed network DF</span></span>
<span><span class="va">Zc_signed</span> <span class="op">&lt;-</span> <span class="fl">0.5</span> <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="va">Zc</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_c.html" class="external-link">str_c</a></span><span class="op">(</span><span class="st">"nrow: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Zc_signed</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "nrow: 1465"</span></span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Choose a set of soft-thresholding powers</span></span>
<span><span class="va">powers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from<span class="op">=</span><span class="fl">11</span>, to<span class="op">=</span><span class="fl">15</span>, by<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cutoff</span> <span class="op">&lt;-</span> <span class="fl">0.8</span></span>
<span></span>
<span><span class="co">#Call the network topology analysis function</span></span>
<span><span class="va">sft</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/WGCNA/man/pickSoftThreshold.html" class="external-link">pickSoftThreshold.fromSimilarity</a></span><span class="op">(</span><span class="va">Zc_signed</span>, RsquaredCut<span class="op">=</span><span class="va">cutoff</span>, powerVector<span class="op">=</span><span class="va">powers</span>, blockSize<span class="op">=</span><span class="fl">5000</span>, verbose<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt;  pickSoftThreshold: calculating connectivity for given powers...</span></span>
<span><span class="co">#&gt;    ..working on genes 1 through 1465 of 1465</span></span>
<span><span class="co">#&gt; Warning: executing %dopar% sequentially: no parallel backend registered</span></span>
<span><span class="co">#&gt;    Power SFT.R.sq  slope truncated.R.sq mean.k. median.k. max.k.</span></span>
<span><span class="co">#&gt; 1      1 0.167000 12.400          0.944  746.00   745.000  806.0</span></span>
<span><span class="co">#&gt; 2      2 0.172000  5.280          0.950  388.00   385.000  459.0</span></span>
<span><span class="co">#&gt; 3      3 0.000524  0.143          0.772  206.00   202.000  276.0</span></span>
<span><span class="co">#&gt; 4      4 0.305000 -2.210          0.730  113.00   108.000  181.0</span></span>
<span><span class="co">#&gt; 5      5 0.705000 -2.770          0.816   63.10    58.700  126.0</span></span>
<span><span class="co">#&gt; 6      6 0.910000 -2.870          0.918   36.60    32.600   94.2</span></span>
<span><span class="co">#&gt; 7      7 0.957000 -2.590          0.948   22.00    18.300   74.3</span></span>
<span><span class="co">#&gt; 8      8 0.936000 -2.350          0.918   13.80    10.500   61.3</span></span>
<span><span class="co">#&gt; 9      9 0.963000 -2.060          0.952    9.15     6.140   52.5</span></span>
<span><span class="co">#&gt; 10    10 0.965000 -1.850          0.955    6.38     3.660   46.4</span></span>
<span><span class="co">#&gt; 11    11 0.960000 -1.710          0.948    4.70     2.250   41.9</span></span>
<span><span class="co">#&gt; 12    12 0.954000 -1.600          0.942    3.65     1.420   38.5</span></span>
<span><span class="co">#&gt; 13    13 0.963000 -1.500          0.955    2.97     0.895   35.9</span></span>
<span><span class="co">#&gt; 14    14 0.974000 -1.430          0.970    2.52     0.581   33.9</span></span>
<span><span class="co">#&gt; 15    15 0.963000 -1.390          0.957    2.21     0.380   32.4</span></span>
<span></span>
<span><span class="co">#Plot the results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>repr.plot.width<span class="op">=</span><span class="fl">9</span>, repr.plot.height<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cex1</span> <span class="op">&lt;-</span> <span class="fl">0.8</span></span>
<span><span class="co">##Scale-free topology fit index as a function of the soft-thresholding power</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sft</span><span class="op">$</span><span class="va">fitIndices</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/sign.html" class="external-link">sign</a></span><span class="op">(</span><span class="va">sft</span><span class="op">$</span><span class="va">fitIndices</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="va">sft</span><span class="op">$</span><span class="va">fitIndices</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"Soft Threshold (power)"</span>, ylab<span class="op">=</span><span class="st">"Scale Free Topology Model Fit, signed R^2"</span>, type<span class="op">=</span><span class="st">"n"</span>,</span>
<span>     main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Scale independence"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">sft</span><span class="op">$</span><span class="va">fitIndices</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/sign.html" class="external-link">sign</a></span><span class="op">(</span><span class="va">sft</span><span class="op">$</span><span class="va">fitIndices</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="va">sft</span><span class="op">$</span><span class="va">fitIndices</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,</span>
<span>     labels<span class="op">=</span><span class="va">powers</span>, cex<span class="op">=</span><span class="va">cex1</span>, col<span class="op">=</span><span class="st">"black"</span><span class="op">)</span></span>
<span><span class="co">##Line corresponds to using an R^2 cut-off of h</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="va">cutoff</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="co">##Mean connectivity as a function of the soft-thresholding power</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sft</span><span class="op">$</span><span class="va">fitIndices</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">sft</span><span class="op">$</span><span class="va">fitIndices</span><span class="op">[</span>,<span class="fl">5</span><span class="op">]</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"Soft Threshold (power)"</span>, ylab<span class="op">=</span><span class="st">"Mean Connectivity"</span>, type<span class="op">=</span><span class="st">"n"</span>,</span>
<span>     main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Mean connectivity"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">sft</span><span class="op">$</span><span class="va">fitIndices</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">sft</span><span class="op">$</span><span class="va">fitIndices</span><span class="op">[</span>,<span class="fl">5</span><span class="op">]</span>, labels<span class="op">=</span><span class="va">powers</span>, cex<span class="op">=</span><span class="va">cex1</span>, col<span class="op">=</span><span class="st">"black"</span><span class="op">)</span></span></code></pre></div>
<p><img src="standardcor-WGCNA_files/figure-html/unnamed-chunk-25-1.png" width="700"></p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_c.html" class="external-link">str_c</a></span><span class="op">(</span><span class="st">"Estimated soft-thresholding power: "</span>, <span class="va">sft</span><span class="op">$</span><span class="va">powerEstimate</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Estimated soft-thresholding power: 6"</span></span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Choose the power that best approximates a scale free topology while still maintaining high level of connectivity in the network</span></span>
<span><span class="va">softPower</span> <span class="op">&lt;-</span> <span class="va">sft</span><span class="op">$</span><span class="va">powerEstimate</span></span>
<span><span class="va">softPower</span></span>
<span><span class="co">#&gt; [1] 6</span></span>
<span><span class="co">#Generate the adjacency matrix using the chosen soft-thresholding power</span></span>
<span><span class="va">adjacency</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/WGCNA/man/adjacency.html" class="external-link">adjacency.fromSimilarity</a></span><span class="op">(</span><span class="va">Zc</span>, power<span class="op">=</span><span class="va">softPower</span>, type<span class="op">=</span><span class="st">"signed"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_c.html" class="external-link">str_c</a></span><span class="op">(</span><span class="st">"nrow: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">adjacency</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "nrow: 1465"</span></span>
<span><span class="co">#head(adjacency)</span></span>
<span></span>
<span><span class="co">#Turn adjacency into topological overlap</span></span>
<span><span class="co">##You can input whatever matrix you want here!</span></span>
<span><span class="co"># Turn adjacency into topological overlap</span></span>
<span><span class="va">TOM</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/WGCNA/man/TOMsimilarity.html" class="external-link">TOMsimilarity</a></span><span class="op">(</span><span class="va">adjacency</span>,TOMType <span class="op">=</span> <span class="st">"signed"</span><span class="op">)</span>;</span>
<span><span class="co">#&gt; ..connectivity..</span></span>
<span><span class="co">#&gt; ..matrix multiplication (system BLAS)..</span></span>
<span><span class="co">#&gt; ..normalization..</span></span>
<span><span class="co">#&gt; ..done.</span></span>
<span><span class="co"># Turn into distance matrix</span></span>
<span><span class="va">dissTOM</span> <span class="op">=</span> <span class="fl">1</span><span class="op">-</span><span class="va">TOM</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dissTOM</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">all_df</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">dissTOM</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dissTOM</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Cluster the TOM distance matrix to find modules</span></span>
<span><span class="co"># Can call whatever clusting method you want here</span></span>
<span></span>
<span><span class="co"># Call the hierarchical clustering function</span></span>
<span><span class="va">geneTree</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/fastcluster/man/hclust.html" class="external-link">hclust</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">as.dist</a></span><span class="op">(</span><span class="va">dissTOM</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"ward.D2"</span><span class="op">)</span>;</span>
<span><span class="co"># Plot the resulting clustering tree (dendrogram)</span></span>
<span><span class="co">#sizeGrWindow(12,9)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">geneTree</span>, xlab<span class="op">=</span><span class="st">""</span>, sub<span class="op">=</span><span class="st">""</span>, main <span class="op">=</span> <span class="st">"Gene clustering on TOM-based dissimilarity"</span>,</span>
<span>    labels <span class="op">=</span> <span class="cn">FALSE</span>, hang <span class="op">=</span> <span class="fl">0.04</span><span class="op">)</span>;</span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/box.html" class="external-link">box</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="standardcor-WGCNA_files/figure-html/unnamed-chunk-27-1.png" width="700"></p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Larger modules can be easier to interpret, so we set the minimum module size relatively high</span></span>
<span><span class="va">minModuleSize</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">all_df</span><span class="op">)</span><span class="op">/</span><span class="fl">200</span>, digits<span class="op">=</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_c.html" class="external-link">str_c</a></span><span class="op">(</span><span class="st">"minClusterSize = "</span>, <span class="va">minModuleSize</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "minClusterSize = 20"</span></span>
<span></span>
<span><span class="co">#Module identification using dynamic tree cut</span></span>
<span><span class="va">dynamicMods</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/dynamicTreeCut/man/cutreeDynamic.html" class="external-link">cutreeDynamic</a></span><span class="op">(</span>dendro<span class="op">=</span><span class="va">geneTree</span>, distM<span class="op">=</span><span class="va">dissTOM</span>,</span>
<span>                             deepSplit<span class="op">=</span><span class="fl">4</span>, pamStage<span class="op">=</span><span class="cn">TRUE</span>, pamRespectsDendro<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                             minClusterSize<span class="op">=</span><span class="va">minModuleSize</span><span class="op">)</span></span>
<span><span class="co">#&gt;  ..cutHeight not given, setting it to 4.94  ===&gt;  99% of the (truncated) height range in dendro.</span></span>
<span><span class="co">#&gt;  ..done.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">dynamicMods</span><span class="op">)</span></span>
<span><span class="co">#&gt; dynamicMods</span></span>
<span><span class="co">#&gt;   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18  19  20 </span></span>
<span><span class="co">#&gt; 499 104  94  78  72  63  60  54  48  47  43  39  32  30  29  28  26  26  25  25 </span></span>
<span><span class="co">#&gt;  21  22 </span></span>
<span><span class="co">#&gt;  22  21</span></span>
<span></span>
<span><span class="co">#Convert numeric lables into colors</span></span>
<span><span class="va">dynamicColors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/WGCNA/man/labels2colors.html" class="external-link">labels2colors</a></span><span class="op">(</span><span class="va">dynamicMods</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">dynamicColors</span><span class="op">)</span></span>
<span><span class="co">#&gt; dynamicColors</span></span>
<span><span class="co">#&gt;        black         blue        brown         cyan    darkgreen      darkred </span></span>
<span><span class="co">#&gt;           60          104           94           30           21           22 </span></span>
<span><span class="co">#&gt;        green  greenyellow       grey60    lightcyan   lightgreen  lightyellow </span></span>
<span><span class="co">#&gt;           72           43           26           28           26           25 </span></span>
<span><span class="co">#&gt;      magenta midnightblue         pink       purple          red    royalblue </span></span>
<span><span class="co">#&gt;           48           29           54           47           63           25 </span></span>
<span><span class="co">#&gt;       salmon          tan    turquoise       yellow </span></span>
<span><span class="co">#&gt;           32           39          499           78</span></span>
<span></span>
<span><span class="co">#Plot the dendrogram and colors underneath</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>repr.plot.width<span class="op">=</span><span class="fl">12</span>, repr.plot.height<span class="op">=</span><span class="fl">6</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/WGCNA/man/plotDendroAndColors.html" class="external-link">plotDendroAndColors</a></span><span class="op">(</span><span class="va">geneTree</span>, <span class="va">dynamicColors</span>, <span class="st">"Dynamic Tree Cut"</span>,</span>
<span>                    dendroLabels<span class="op">=</span><span class="cn">FALSE</span>, hang<span class="op">=</span><span class="fl">0.03</span>,</span>
<span>                    addGuide<span class="op">=</span><span class="cn">TRUE</span>, guideHang<span class="op">=</span><span class="fl">0.05</span>,</span>
<span>                    main<span class="op">=</span><span class="st">"Gene dendrogram and module colors"</span><span class="op">)</span></span></code></pre></div>
<p><img src="standardcor-WGCNA_files/figure-html/unnamed-chunk-28-1.png" width="700"></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Calculate eigengenes</span></span>
<span><span class="va">MEList</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/WGCNA/man/moduleEigengenes.html" class="external-link">moduleEigengenes</a></span><span class="op">(</span><span class="va">all_df</span>, colors<span class="op">=</span><span class="va">dynamicColors</span>, impute<span class="op">=</span><span class="cn">TRUE</span>, nPC<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">MEs</span> <span class="op">&lt;-</span> <span class="va">MEList</span><span class="op">$</span><span class="va">eigengenes</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_c.html" class="external-link">str_c</a></span><span class="op">(</span><span class="st">"nrow: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">MEs</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "nrow: 500"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">MEs</span><span class="op">)</span></span>
<span><span class="co">#&gt;       MEblack       MEblue      MEbrown       MEcyan  MEdarkgreen     MEdarkred</span></span>
<span><span class="co">#&gt; 1 -0.04250164 -0.006137058 -0.061119212 -0.017963073  0.083685677  2.766099e-02</span></span>
<span><span class="co">#&gt; 2  0.07743639  0.062143054 -0.024485473  0.030683603 -0.021758338 -4.796828e-05</span></span>
<span><span class="co">#&gt; 3  0.03539161  0.026002054 -0.073829551  0.011904043  0.006682852  2.677434e-02</span></span>
<span><span class="co">#&gt; 4 -0.01816194 -0.021918239  0.006197687 -0.005365383 -0.030132389  1.233884e-02</span></span>
<span><span class="co">#&gt; 5  0.01788601  0.014131597 -0.090108419  0.041251157  0.012587136 -6.189113e-02</span></span>
<span><span class="co">#&gt; 6  0.02603770  0.001758729 -0.043114754  0.024930105  0.001555772 -1.455030e-02</span></span>
<span><span class="co">#&gt;       MEgreen MEgreenyellow     MEgrey60 MElightcyan  MElightgreen</span></span>
<span><span class="co">#&gt; 1  0.09667654    0.04224804 -0.011219413  0.02270412 -0.0009493078</span></span>
<span><span class="co">#&gt; 2  0.01144213    0.06930301  0.011247960  0.03394327  0.0926655585</span></span>
<span><span class="co">#&gt; 3  0.03526924    0.04939254  0.005733386  0.02926117  0.0418565133</span></span>
<span><span class="co">#&gt; 4 -0.02069531    0.02095189  0.032070655 -0.00474506 -0.0296049856</span></span>
<span><span class="co">#&gt; 5  0.06652515   -0.01577464 -0.105567516  0.02761338  0.0080213115</span></span>
<span><span class="co">#&gt; 6  0.06117528    0.01558672 -0.039090274  0.02622454 -0.0552738630</span></span>
<span><span class="co">#&gt;   MElightyellow    MEmagenta MEmidnightblue       MEpink     MEpurple</span></span>
<span><span class="co">#&gt; 1   0.054813453  0.017014383   -0.060639183 -0.041704707  0.015084532</span></span>
<span><span class="co">#&gt; 2   0.006505377  0.021206367    0.041181322  0.016637743  0.070252083</span></span>
<span><span class="co">#&gt; 3   0.028960827  0.004705876   -0.013260868 -0.049713898  0.067356769</span></span>
<span><span class="co">#&gt; 4   0.010579150  0.037737960   -0.009881932  0.001515955 -0.039509676</span></span>
<span><span class="co">#&gt; 5   0.012931648 -0.018482246    0.068292959 -0.094043994 -0.038940804</span></span>
<span><span class="co">#&gt; 6  -0.021155760  0.039405631    0.053630301 -0.039897490  0.002201621</span></span>
<span><span class="co">#&gt;          MEred  MEroyalblue   MEsalmon         MEtan MEturquoise     MEyellow</span></span>
<span><span class="co">#&gt; 1  0.004533408  0.056728907 0.01880385  0.0104194410 -0.03167811 -0.007773314</span></span>
<span><span class="co">#&gt; 2  0.022852213 -0.027008752 0.04014007 -0.0451096975  0.01457797 -0.013980877</span></span>
<span><span class="co">#&gt; 3  0.065539735  0.034050318 0.03833421 -0.0105466068 -0.05322893 -0.037205440</span></span>
<span><span class="co">#&gt; 4  0.005094828  0.003775484 0.01594035 -0.0039805473  0.01949922 -0.013305095</span></span>
<span><span class="co">#&gt; 5 -0.056656398 -0.091232433 0.01890705 -0.0649936854 -0.02318406 -0.118914485</span></span>
<span><span class="co">#&gt; 6  0.055026948 -0.008089793 0.04426588 -0.0002465442 -0.06392858 -0.075245659</span></span>
<span></span>
<span><span class="co">#Calculate dissimilarity of module eigengenes</span></span>
<span><span class="va">MEDiss</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/pkg/WGCNA/man/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">MEs</span>, use<span class="op">=</span><span class="st">"pairwise.complete.obs"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Cluster module eigengenes</span></span>
<span><span class="va">METree</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/fastcluster/man/hclust.html" class="external-link">hclust</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">as.dist</a></span><span class="op">(</span><span class="va">MEDiss</span><span class="op">)</span>, method<span class="op">=</span><span class="st">"ward.D2"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Plot the result</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>repr.plot.width<span class="op">=</span><span class="fl">10</span>, repr.plot.height<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">METree</span>, main<span class="op">=</span><span class="st">"Clustering of module eigengenes"</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">""</span>, sub<span class="op">=</span><span class="st">""</span><span class="op">)</span></span>
<span><span class="va">MEDissThres</span> <span class="op">&lt;-</span> <span class="fl">0.3</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="va">MEDissThres</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<p><img src="standardcor-WGCNA_files/figure-html/unnamed-chunk-29-1.png" width="700"></p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Call an automatic merging function</span></span>
<span><span class="va">merge</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/WGCNA/man/mergeCloseModules.html" class="external-link">mergeCloseModules</a></span><span class="op">(</span><span class="va">all_df</span>, <span class="va">dynamicColors</span>, cutHeight<span class="op">=</span><span class="va">MEDissThres</span>, verbose<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Eigengenes of the new merged modules</span></span>
<span><span class="va">mergedMEs</span> <span class="op">&lt;-</span> <span class="va">merge</span><span class="op">$</span><span class="va">newMEs</span></span>
<span></span>
<span><span class="co">#The merged module colors</span></span>
<span><span class="va">mergedColors</span> <span class="op">&lt;-</span> <span class="va">merge</span><span class="op">$</span><span class="va">colors</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">mergedColors</span><span class="op">)</span></span>
<span><span class="co">#&gt; mergedColors</span></span>
<span><span class="co">#&gt;        blue       brown   darkgreen     darkred       green greenyellow </span></span>
<span><span class="co">#&gt;         223          94          46          22          72          43 </span></span>
<span><span class="co">#&gt;      grey60   lightcyan  lightgreen     magenta        pink      purple </span></span>
<span><span class="co">#&gt;          26          60          26          48          54          47 </span></span>
<span><span class="co">#&gt;         red   royalblue         tan   turquoise      yellow </span></span>
<span><span class="co">#&gt;          63          25          39         499          78</span></span>
<span></span>
<span><span class="co">#Plot the dendrogram and module colors</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>repr.plot.width<span class="op">=</span><span class="fl">12</span>, repr.plot.height<span class="op">=</span><span class="fl">6</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/WGCNA/man/plotDendroAndColors.html" class="external-link">plotDendroAndColors</a></span><span class="op">(</span><span class="va">geneTree</span>, <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">dynamicColors</span>, <span class="va">mergedColors</span><span class="op">)</span>,</span>
<span>                    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Dynamic Tree Cut"</span>, <span class="st">"Merged dynamic"</span><span class="op">)</span>,</span>
<span>                    dendroLabels<span class="op">=</span><span class="cn">FALSE</span>, hang<span class="op">=</span><span class="fl">0.03</span>,</span>
<span>                    addGuide<span class="op">=</span><span class="cn">TRUE</span>, guideHang<span class="op">=</span><span class="fl">0.05</span>,</span>
<span>                    main<span class="op">=</span><span class="st">"Gene dendrogram and module colors"</span><span class="op">)</span></span></code></pre></div>
<p><img src="standardcor-WGCNA_files/figure-html/unnamed-chunk-30-1.png" width="700"></p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">#Rename</span></span>
<span><span class="va">moduleColors</span> <span class="op">&lt;-</span> <span class="va">mergedColors</span></span>
<span><span class="va">MEs</span> <span class="op">&lt;-</span> <span class="va">mergedMEs</span></span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Rename</span></span>
<span><span class="va">moduleColors</span> <span class="op">&lt;-</span> <span class="va">mergedColors</span></span>
<span><span class="va">MEs</span> <span class="op">&lt;-</span> <span class="va">mergedMEs</span></span>
<span></span>
<span><span class="co">#Clean the module eigengene table</span></span>
<span><span class="va">eigengene_df</span> <span class="op">&lt;-</span> <span class="va">MEs</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">rownames_to_column</a></span><span class="op">(</span>var<span class="op">=</span><span class="st">"public_client_id"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">eigengene_df</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">eigengene_df</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">eigengene_df</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">eigengene_df</span><span class="op">)</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html" class="external-link">str_replace</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">"^ME"</span>, <span class="st">""</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://stringr.tidyverse.org/reference/case.html" class="external-link">str_to_title</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Module eigengene table"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Module eigengene table"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_c.html" class="external-link">str_c</a></span><span class="op">(</span><span class="st">"- nrow: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">eigengene_df</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "- nrow: 500"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">eigengene_df</span><span class="op">)</span></span>
<span><span class="co">#&gt;   public_client_id       Green   Turquoise Greenyellow   Lightcyan        Blue</span></span>
<span><span class="co">#&gt; 1                1  0.09667654 -0.03167811  0.04224804 0.021016558 -0.03960362</span></span>
<span><span class="co">#&gt; 2                2  0.01144213  0.01457797  0.06930301 0.038385247  0.05453270</span></span>
<span><span class="co">#&gt; 3                3  0.03526924 -0.05322893  0.04939254 0.035184316  0.01207804</span></span>
<span><span class="co">#&gt; 4                4 -0.02069531  0.01949922  0.02095189 0.005809384 -0.01353862</span></span>
<span><span class="co">#&gt; 5                5  0.06652515 -0.02318406 -0.01577464 0.024391282  0.04479661</span></span>
<span><span class="co">#&gt; 6                6  0.06117528 -0.06392858  0.01558672 0.038461457  0.03384631</span></span>
<span><span class="co">#&gt;      Darkgreen       Darkred    Royalblue           Tan          Red</span></span>
<span><span class="co">#&gt; 1  0.072203330  2.766099e-02  0.056728907  0.0104194410  0.004533408</span></span>
<span><span class="co">#&gt; 2 -0.007447819 -4.796828e-05 -0.027008752 -0.0451096975  0.022852213</span></span>
<span><span class="co">#&gt; 3  0.018880591  2.677434e-02  0.034050318 -0.0105466068  0.065539735</span></span>
<span><span class="co">#&gt; 4 -0.009537316  1.233884e-02  0.003775484 -0.0039805473  0.005094828</span></span>
<span><span class="co">#&gt; 5  0.013223197 -6.189113e-02 -0.091232433 -0.0649936854 -0.056656398</span></span>
<span><span class="co">#&gt; 6 -0.010730048 -1.455030e-02 -0.008089793 -0.0002465442  0.055026948</span></span>
<span><span class="co">#&gt;        Magenta    Lightgreen       Purple        Brown         Pink</span></span>
<span><span class="co">#&gt; 1  0.017014383 -0.0009493078  0.015084532 -0.061119212 -0.041704707</span></span>
<span><span class="co">#&gt; 2  0.021206367  0.0926655585  0.070252083 -0.024485473  0.016637743</span></span>
<span><span class="co">#&gt; 3  0.004705876  0.0418565133  0.067356769 -0.073829551 -0.049713898</span></span>
<span><span class="co">#&gt; 4  0.037737960 -0.0296049856 -0.039509676  0.006197687  0.001515955</span></span>
<span><span class="co">#&gt; 5 -0.018482246  0.0080213115 -0.038940804 -0.090108419 -0.094043994</span></span>
<span><span class="co">#&gt; 6  0.039405631 -0.0552738630  0.002201621 -0.043114754 -0.039897490</span></span>
<span><span class="co">#&gt;         Grey60       Yellow</span></span>
<span><span class="co">#&gt; 1 -0.011219413 -0.007773314</span></span>
<span><span class="co">#&gt; 2  0.011247960 -0.013980877</span></span>
<span><span class="co">#&gt; 3  0.005733386 -0.037205440</span></span>
<span><span class="co">#&gt; 4  0.032070655 -0.013305095</span></span>
<span><span class="co">#&gt; 5 -0.105567516 -0.118914485</span></span>
<span><span class="co">#&gt; 6 -0.039090274 -0.075245659</span></span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">##Sample metadata</span></span>
<span><span class="va">sample_tbl</span> <span class="op">&lt;-</span> <span class="va">pheno</span><span class="op">[</span><span class="va">pheno</span><span class="op">$</span><span class="va">subjectID</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">MEs</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Sample metadata after the filter"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Sample metadata after the filter"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_c.html" class="external-link">str_c</a></span><span class="op">(</span><span class="st">"- nrow: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">sample_tbl</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "- nrow: 500"</span></span>
<span></span>
<span><span class="co">#Code sex and race</span></span>
<span><span class="va">phenotype_tbl</span> <span class="op">&lt;-</span> <span class="va">sample_tbl</span> </span>
<span></span>
<span><span class="va">phenotype_tbl</span> <span class="op">&lt;-</span> <span class="va">phenotype_tbl</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">MEs</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">phenotype_tbl</span><span class="op">)</span><span class="op">)</span>,<span class="op">]</span></span></code></pre></div>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Calculate the numbers of modules and samples</span></span>
<span><span class="co">#nModules &lt;- ncol(MEs)</span></span>
<span><span class="va">nSamples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">phenotype_tbl</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Names (colors) of the modules</span></span>
<span><span class="va">modNames</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substring</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">MEs</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co">##Check ID order before the cor() function</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_c.html" class="external-link">str_c</a></span><span class="op">(</span><span class="st">"Matched IDs?: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">MEs</span><span class="op">)</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">phenotype_tbl</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Matched IDs?: TRUE"</span></span>
<span></span>
<span><span class="co">#Calculate module–trait relationship</span></span>
<span><span class="va">moduleTraitCor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/WGCNA/man/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">MEs</span>, <span class="va">phenotype_tbl</span>, use<span class="op">=</span><span class="st">"p"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">moduleTraitCor</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/case.html" class="external-link">str_to_title</a></span><span class="op">(</span><span class="va">modNames</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Module–trait relationship table"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Module–trait relationship table"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_c.html" class="external-link">str_c</a></span><span class="op">(</span><span class="st">"nrow: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">moduleTraitCor</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "nrow: 17"</span></span>
<span></span>
<span><span class="co">#Calculate statisitcal significance of module–trait relationship</span></span>
<span><span class="va">MTRpval</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/WGCNA/man/corPvalueStudent.html" class="external-link">corPvalueStudent</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">moduleTraitCor</span><span class="op">)</span>, <span class="va">nSamples</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">MTRpval</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/case.html" class="external-link">str_to_title</a></span><span class="op">(</span><span class="va">modNames</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Module–trait relationship p-value table"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Module–trait relationship p-value table"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_c.html" class="external-link">str_c</a></span><span class="op">(</span><span class="st">"- nrow: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">MTRpval</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "- nrow: 17"</span></span>
<span></span>
<span><span class="co">#Eliminate the dummy module (Grey)</span></span>
<span><span class="va">moduleTraitCor</span> <span class="op">&lt;-</span> <span class="va">moduleTraitCor</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">moduleTraitCor</span><span class="op">)</span><span class="op">!=</span><span class="st">"Grey"</span>,<span class="op">]</span></span>
<span><span class="va">MTRpval</span> <span class="op">&lt;-</span> <span class="va">MTRpval</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">MTRpval</span><span class="op">)</span><span class="op">!=</span><span class="st">"Grey"</span>,<span class="op">]</span></span>
<span></span>
<span><span class="co">#P-value adjustment across modules (per trait) using Benjamini–Hochberg method</span></span>
<span><span class="va">MTRpval_adj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">MTRpval</span>, <span class="fl">2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">p.adjust</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, method<span class="op">=</span><span class="st">"BH"</span><span class="op">)</span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Module–trait relationship adjusted p-value table"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Module–trait relationship adjusted p-value table"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_c.html" class="external-link">str_c</a></span><span class="op">(</span><span class="st">"- nrow: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">MTRpval_adj</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "- nrow: 17"</span></span>
<span></span>
<span><span class="co">#Prepare text labels as matrix</span></span>
<span><span class="va">textMatrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"r = "</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">signif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">moduleTraitCor</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>,<span class="st">"\n(P = "</span>,</span>
<span>                    <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">signif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">MTRpval_adj</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,<span class="st">")"</span>, sep<span class="op">=</span><span class="st">""</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">textMatrix</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">moduleTraitCor</span><span class="op">)</span></span>
<span><span class="co">#Revert module names back to apply color conversion</span></span>
<span><span class="va">temp_c</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">moduleTraitCor</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://stringr.tidyverse.org/reference/case.html" class="external-link">str_to_lower</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_c.html" class="external-link">str_c</a></span><span class="op">(</span><span class="st">"ME"</span>,<span class="va">.</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Visualize</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>repr.plot.width<span class="op">=</span><span class="fl">10</span>, repr.plot.height<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/WGCNA/man/labeledHeatmap.html" class="external-link">labeledHeatmap</a></span><span class="op">(</span>Matrix<span class="op">=</span><span class="va">moduleTraitCor</span>,</span>
<span>               xLabels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">moduleTraitCor</span><span class="op">)</span>,</span>
<span>               yLabels<span class="op">=</span><span class="va">temp_c</span>,</span>
<span>               <span class="co">#ySymbols=rownames(moduleTraitCor),</span></span>
<span>               colorLabels<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>               colors<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/WGCNA/man/blueWhiteRed.html" class="external-link">blueWhiteRed</a></span><span class="op">(</span><span class="fl">50</span><span class="op">)</span>,</span>
<span>               textMatrix<span class="op">=</span><span class="va">textMatrix</span>,</span>
<span>               setStdMargins<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>               cex.text<span class="op">=</span><span class="fl">1</span>,</span>
<span>               zlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>               main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Module–trait relationships"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="standardcor-WGCNA_files/figure-html/unnamed-chunk-34-1.png" width="576"></p>
<p>Now that we have identified modules asssociated with a phenotype, we
can take the analysis in many other directions. Please refer to the
WGCNA documentation for more information.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Max Robinson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
