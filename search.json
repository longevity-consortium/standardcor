[{"path":"https://longevity-consortium.github.io/standardcor/articles/Getting-Started.html","id":"estimate-shapes","dir":"Articles","previous_headings":"","what":"Estimate Shapes","title":"Getting-Started","text":"first example estimates parameters (asymmetric) Beta distribution Beta(v,w)Beta(v,w) data generated entirely null distribution correlations among vectors length D=50D = 50. Theoretically, distribution Beta(v,v),v=D/2−1=24Beta(v,v), v = D/2 - 1 = 24; example shows estimateShape() good job fitting data.  second example estimates parameters null model data, except 20% vectors now 50% correlated . correlations, null model, involve 4% unique, non-identical pairs. null model, representing 96% pairs, identical previous example. example, can see Method Moments estimate, perfectly appropriate first example, tries include correlations rather just null model. result, fitted distribution reflect null model well. contrast, estimateShape() much better modeling just correlations truly null model.  third example, show difference using null model directly distance versus using null model penalty top typical Euclidean distance corresponding corrolation coefficient. betaDistance() function penalizes correlation coefficients likely null model, doesn’t penalize correlation coefficients larger predicted null model. Without including Euclidean distance, essentially distance highly correlated pairs; including Euclidean distance, highly correlated pairs can still separated degree correlation.","code":"Samples <- 1000 Dimensions <- 50 M <- Matrix(rnorm(Dimensions*Samples),nrow=Dimensions,ncol=Samples,sparse=TRUE) Z <- SparseSpearmanCor2(M)  beta.shape <- estimateShape(Z[row(Z) < col(Z)], plot=TRUE) title(paste(round(beta.shape,2),collapse=\", \"),line=0.5) #text(x=-0.5,y=2.0,labels=paste(\"D/2 - 1 = \",round(Dimensions/2-1, 2)),adj = 1/2)  R <- c(-100:100)/100 ; R <-ifelse(-1 < R, ifelse(R < 1, R, 1), -1) # Ensure R in [-1,1]  x     <- (1+Z[row(Z) < col(Z)])/2 x.mu  <- mean(x) x.var <- var(x) z.mm <- x.mu*(1-x.mu) / x.var - 1 v.mm <- x.mu * z.mm w.mm <- (1-x.mu) * z.mm  lines(R,dbeta((1+R)/2, v.mm, w.mm)/2, lwd=3, col='forestgreen') text(x=0.5,y=c(2.3,2),      labels=c(\"Method of Moments\",paste(\"Beta(\",round(v.mm, 2),\",\",round(w.mm,2),\")\",sep='')),      col='forestgreen',adj = 1/2) Samples <- 1000 Dimensions <- 50 M <- Matrix(rnorm(Dimensions*Samples),nrow=Dimensions,ncol=Samples,sparse=TRUE) Altered <- 200 # This 5% of the samples are officially \"outliers\" r <- 0.5 M[,c(1:Altered)] <- (1-r) * M[,c(1:Altered)] + r*M[,Altered+1] Z <- SparseSpearmanCor2(M) beta.shape <- estimateShape(Z[row(Z) < col(Z)], plot=TRUE) title(paste(\"Beta(\",paste(round(beta.shape,2),collapse=\", \"),\")\",sep=''),line=0.5) #text(x=-0.5,y=2.0,labels=paste(\"D/2 - 1 = \",round(Dimensions/2-1, 2)),adj = 1/2)  R <- c(-100:100)/100 ; R <-ifelse(-1 < R, ifelse(R < 1, R, 1), -1) # Ensure R in [-1,1]  x     <- (1+Z[row(Z) < col(Z)])/2 x.mu  <- mean(x) x.var <- var(x) z.mm <- x.mu*(1-x.mu) / x.var - 1 v.mm <- x.mu * z.mm w.mm <- (1-x.mu) * z.mm  lines(R,dbeta((1+R)/2, v.mm, w.mm)/2, lwd=3, col='forestgreen') text(x=0.5,y=c(2.3,2),      labels=c(\"Method of Moments\",paste(\"Beta(\",round(v.mm, 2),\",\",round(w.mm,2),\")\",sep='')),      col='forestgreen',adj = 1/2) v <- mean(beta.shape) # Expect v = (D-1)/2 = 24.5 v.name <- paste(\"Beta(\",paste(round(c(v,v),2),collapse=\", \"),\")\",sep='') plot(R,betaDistance(R, v, v, mix=0), type='l',lwd=3,      xlab=\"Correlation coefficient\", ylab=\"Distance Penalty\",     main = paste(v.name,\"penalty\")) abline(h=c(-1:1),col='grey') ; abline(v=c(0,1),col='grey') plot(R,betaDistance(R, v, v, mix=1),type='l',lwd=3,      xlab=\"Correlation coefficient\", ylab=\"Relative Distance\",     main = c(\"Euclidean distance squared mixed with\",              paste(v.name, \"penalty\"))) abline(h=c(-1:1),col='grey') ; abline(v=c(0,1),col='grey')"},{"path":"https://longevity-consortium.github.io/standardcor/articles/Getting-Started.html","id":"multi-omic-data-example","dir":"Articles","previous_headings":"","what":"Multi-omic data example","title":"Getting-Started","text":"Proteomics correlation matrix 284 x 284 0 na values -0.641119940479762 <= cor <= 1","code":"data('synth_LC') names(synth_LC) <- c('Metadata','Metabolomics','Proteomics') Z.met <- SparseSpearmanCor2(as.matrix(synth_LC[['Metabolomics']])) dim(Z.met) #> [1] 2647 2647 length(which(is.na(Z.met))) #> [1] 0 range(Z.met,na.rm=TRUE) #> [1] -0.8189155  1.0000000 shape.Met <- estimateShape(Z.met[row(Z.met) < col(Z.met)], plot=TRUE) title(paste('Metabolite correlations',paste(round(shape.Met,2),collapse=\", \")),line=0.5) Z.prot <- SparseSpearmanCor2(as.matrix(synth_LC[['Proteomics']])) shape.prot <- estimateShape(Z.prot[row(Z.prot) < col(Z.prot)], plot=TRUE) title(paste('Protein correlations',paste(round(shape.prot,2),collapse=\", \")),line=0.5) N <- dim(synth_LC[['Metabolomics']])[2] Met <- as.matrix(synth_LC[['Metabolomics']][,2:N]) rownames(Met) <- synth_LC[['Metabolomics']]$subjectID  N <- dim(synth_LC[['Proteomics']])[2] Prot <- as.matrix(synth_LC[['Proteomics']][,2:N]) rownames(Prot) <- synth_LC[['Proteomics']]$subjectID par(mar = c(2, 2, 4, 2), mfrow=c(2,2)) L <- multiOmicModel(list(met = Met, prot = Prot), plot=TRUE, annotate=TRUE, fine=30)  v.std <- 32 Z <- standardizeFromModel(L$modelL, L$analyteL, v.std) adjTable1 <- nullModelAdjacencyTable(Z[row(Z) < col(Z)], v.std, scale=1) adjTable2 <- nullModelAdjacencyTable(Z[row(Z) < col(Z)], v.std) adjTable3 <- nullModelAdjacencyTable(Z[row(Z) < col(Z)], v.std, scale=3)  shape <- estimateShape(Z[row(Z) < col(Z)], plot=TRUE, main = \"Standardized\", fine=30) title(paste(\"Beta(\",v.std,\",\",v.std,\")\",sep=''), line = 0.5) Bs <- c(-100:100)/100 lines(Bs,interpolatedAdjacency(Bs,adjTable1),lwd=3,col='orangered') lines(Bs,interpolatedAdjacency(Bs,adjTable2),lwd=3,col='forestgreen') lines(Bs,interpolatedAdjacency(Bs,adjTable3),lwd=3,col='dodgerblue')"},{"path":"https://longevity-consortium.github.io/standardcor/articles/Getting-Started.html","id":"beta-distance-function","dir":"Articles","previous_headings":"","what":"Beta distance function","title":"Getting-Started","text":"","code":"R <- c(-100:100)/100 ; R <- ifelse(R < -1, -1, ifelse(1 < R, 1, R))  par(mar = c(2, 2, 4, 2), mfrow=c(2,2))  plot(R,betaDistance(R,1,1,mix=0,unsigned=FALSE),type='l',lwd=3, ylim=c(0,1),      xlab=\"Correlation coefficient\", ylab=\"Beta Distance\",     main = \"Beta(v = 1, w = 1), signed, unmixed\") abline(h=c(-1:1),col='grey') ; abline(v=c(0,1),col='grey')  plot(R,betaDistance(R, 3, 6, mix=0, unsigned=FALSE),type='l',lwd=3, ylim=c(0,1),      xlab=\"Correlation coefficient\", ylab=\"Beta Distance\",     main = \"Beta(v = 3, w = 6), signed, unmixed\") abline(h=c(-1:1),col='grey') ; abline(v=c(0,1),col='grey')  plot(R,betaDistance(R, 6, 3, mix=0,unsigned=FALSE),type='l',lwd=3, ylim=c(0,1),      xlab=\"Correlation coefficient\", ylab=\"Beta Distance\",     main = \"Beta(v = 6, w = 3), signed, unmixed\") abline(h=c(-1:1),col='grey') ; abline(v=c(0,1),col='grey')  plot(R,betaDistance(R, 30, 30,mix=0,unsigned=FALSE),type='l',lwd=3, ylim=c(0,1),      xlab=\"Correlation coefficient\", ylab=\"Beta Distance\",     main = \"Beta(v = 30, w = 30), signed, unmixed\") abline(h=c(-1:1),col='grey') ; abline(v=c(0,1),col='grey') R <- c(-100:100)/100 ; R <- ifelse(R < -1, -1, ifelse(1 < R, 1, R))  par(mar = c(2, 2, 4, 2), mfrow=c(2,2))  plot(R,betaDistance(R,1,1,mix=1,unsigned=FALSE),type='l',lwd=3,      xlab=\"Correlation coefficient\", ylab=\"Beta Distance\",     main = \"Beta(v = 1, w = 1), signed, mixed\") abline(h=c(-1:1),col='grey') ; abline(v=c(0,1),col='grey')  plot(R,betaDistance(R, 3, 6, mix=1, unsigned=FALSE),type='l',lwd=3,      xlab=\"Correlation coefficient\", ylab=\"Beta Distance\",     main = \"Beta(v = 3, w = 6), signed, mixed\") abline(h=c(-1:1),col='grey') ; abline(v=c(0,1),col='grey')  plot(R,betaDistance(R, 6, 3, mix=1,unsigned=FALSE),type='l',lwd=3,      xlab=\"Correlation coefficient\", ylab=\"Beta Distance\",     main = \"Beta(v = 6, w = 3), signed, mixed\") abline(h=c(-1:1),col='grey') ; abline(v=c(0,1),col='grey')  plot(R,betaDistance(R, 30, 30,mix=1,unsigned=FALSE),type='l',lwd=3,      xlab=\"Correlation coefficient\", ylab=\"Beta Distance\",     main = \"Beta(v = 30, w = 30), signed, mixed\") abline(h=c(-1:1),col='grey') ; abline(v=c(0,1),col='grey') R <- c(-100:100)/100 ; R <- ifelse(R < -1, -1, ifelse(1 < R, 1, R))  par(mar = c(2, 2, 4, 2), mfrow=c(2,2))  plot(R,betaDistance(R,1,1,mix=0),type='l',lwd=3, ylim=c(0,1),      xlab=\"Correlation coefficient\", ylab=\"Beta Distance\",     main = \"Beta(v = 1, w = 1), unsigned, unmixed\") abline(h=c(-1:1),col='grey') ; abline(v=c(0,1),col='grey')  plot(R,betaDistance(R, 3, 6, mix=0),type='l',lwd=3, ylim=c(0,1),      xlab=\"Correlation coefficient\", ylab=\"Beta Distance\",     main = \"Beta(v = 3, w = 6), unsigned, unmixed\") abline(h=c(-1:1),col='grey') ; abline(v=c(0,1),col='grey')  plot(R,betaDistance(R, 6, 3, mix=0),type='l',lwd=3, ylim=c(0,1),      xlab=\"Correlation coefficient\", ylab=\"Beta Distance\",     main = \"Beta(v = 6, w = 3), unsigned, unmixed\") abline(h=c(-1:1),col='grey') ; abline(v=c(0,1),col='grey')  plot(R,betaDistance(R, 30, 30,mix=0),type='l',lwd=3, ylim=c(0,1),      xlab=\"Correlation coefficient\", ylab=\"Beta Distance\",     main = \"Beta(v = 30, w = 30), unsigned, unmixed\") abline(h=c(-1:1),col='grey') ; abline(v=c(0,1),col='grey') R <- c(-100:100)/100 ; R <- ifelse(R < -1, -1, ifelse(1 < R, 1, R))  par(mar = c(2, 2, 4, 2), mfrow=c(2,2))  plot(R,betaDistance(R,1,1),type='l',lwd=3, ylim=c(0,1),      xlab=\"Correlation coefficient\", ylab=\"Beta Distance\",     main = \"Beta(v = 1, w = 1), unsigned, mixed\") abline(h=c(-1:1),col='grey') ; abline(v=c(0,1),col='grey')  plot(R,betaDistance(R, 3, 6),type='l',lwd=3, ylim=c(0,1),      xlab=\"Correlation coefficient\", ylab=\"Beta Distance\",     main = \"Beta(v = 3, w = 6), unsigned, mixed\") abline(h=c(-1:1),col='grey') ; abline(v=c(0,1),col='grey')  plot(R,betaDistance(R, 6, 3),type='l',lwd=3, ylim=c(0,1),      xlab=\"Correlation coefficient\", ylab=\"Beta Distance\",     main = \"Beta(v = 6, w = 3), unsigned, mixed\") abline(h=c(-1:1),col='grey') ; abline(v=c(0,1),col='grey')  plot(R,betaDistance(R, 30, 30),type='l',lwd=3, ylim=c(0,1),      xlab=\"Correlation coefficient\", ylab=\"Beta Distance\",     main = \"Beta(v = 30, w = 30), unsigned, mixed\") abline(h=c(-1:1),col='grey') ; abline(v=c(0,1),col='grey')"},{"path":"https://longevity-consortium.github.io/standardcor/articles/Getting-Started.html","id":"power-distance-function","dir":"Articles","previous_headings":"","what":"Power distance function","title":"Getting-Started","text":"","code":"R <- c(-100:100)/100 ; R <- ifelse(R < -1, -1, ifelse(1 < R, 1, R))  par(mar = c(2, 2, 4, 2), mfrow=c(2,2))  plot(R,powerDistance(R,k=3,unsigned=FALSE),type='l',lwd=3, ylim=c(0,1),      xlab=\"Correlation coefficient\", ylab=\"Power Distance\",     main = \"k = 3, unsigned\") abline(h=c(-1:1),col='grey') ; abline(v=c(0,1),col='grey')  plot(R,powerDistance(R,k=6, unsigned=FALSE),type='l',lwd=3, ylim=c(0,1),      xlab=\"Correlation coefficient\", ylab=\"Power Distance\",     main = \"k = 6, unsigned\") abline(h=c(-1:1),col='grey') ; abline(v=c(0,1),col='grey')  plot(R,powerDistance(R,k=12, unsigned=FALSE),type='l',lwd=3, ylim=c(0,1),      xlab=\"Correlation coefficient\", ylab=\"Power Distance\",     main = \"k = 12, unsigned\") abline(h=c(-1:1),col='grey') ; abline(v=c(0,1),col='grey')  plot(R,powerDistance(R,k=0.5, unsigned=FALSE),type='l',lwd=3, ylim=c(0,1),      xlab=\"Correlation coefficient\", ylab=\"Power Distance\",     main = \"k = 0.5, unsigned\") abline(h=c(-1:1),col='grey') ; abline(v=c(0,1),col='grey') R <- c(-100:100)/100 ; R <- ifelse(R < -1, -1, ifelse(1 < R, 1, R))  par(mar = c(2, 2, 4, 2), mfrow=c(2,2))  plot(R,powerDistance(R,k=3),type='l',lwd=3, ylim=c(0,1),      xlab=\"Correlation coefficient\", ylab=\"Power Distance\",     main = \"k = 3, unsigned\") abline(h=c(-1:1),col='grey') ; abline(v=c(0,1),col='grey')  plot(R,powerDistance(R,k=6),type='l',lwd=3, ylim=c(0,1),      xlab=\"Correlation coefficient\", ylab=\"Power Distance\",     main = \"k = 6, unsigned\") abline(h=c(-1:1),col='grey') ; abline(v=c(0,1),col='grey')  plot(R,powerDistance(R,k=12),type='l',lwd=3, ylim=c(0,1),      xlab=\"Correlation coefficient\", ylab=\"Power Distance\",     main = \"k = 12, unsigned\") abline(h=c(-1:1),col='grey') ; abline(v=c(0,1),col='grey')  plot(R,powerDistance(R,k=0.5),type='l',lwd=3, ylim=c(0,1),      xlab=\"Correlation coefficient\", ylab=\"Power Distance\",     main = \"k = 0.5, unsigned\") abline(h=c(-1:1),col='grey') ; abline(v=c(0,1),col='grey')"},{"path":"https://longevity-consortium.github.io/standardcor/articles/Getting-Started.html","id":"sigmoid-distance-function","dir":"Articles","previous_headings":"","what":"Sigmoid distance function","title":"Getting-Started","text":"","code":"R <- c(-100:100)/100 ; R <- ifelse(R < -1, -1, ifelse(1 < R, 1, R))  par(mar = c(2, 2, 4, 2), mfrow=c(2,2))  plot(R,sigmoidDistance(R,alpha=5,tau0 = 0,unsigned=FALSE),type='l',lwd=3,      xlab=\"Correlation coefficient\", ylab=\"Sigmoid Distance\",     main = \"sigmoid(5, 0), unsigned\",ylim=c(0,1)) abline(v=c(-1:1),col='grey') ; abline(h=c(0,1),col='grey') abline(h=0.5, lty=2, col='grey')  plot(R,sigmoidDistance(R,alpha=5,tau0 = 1,unsigned=FALSE),type='l',lwd=3,      xlab=\"Correlation coefficient\", ylab=\"Sigmoid Distance\",     main = \"sigmoid(5, 1), unsigned\",ylim=c(0,1)) abline(v=c(-1:1),col='grey') ; abline(h=c(0,1),col='grey') abline(h=0.5, lty=2, col='grey')  plot(R,sigmoidDistance(R,alpha=25,tau0 = -0.5,unsigned=FALSE),type='l',lwd=3,      xlab=\"Correlation coefficient\", ylab=\"Sigmoid Distance\",     main = \"sigmoid(25, -1/2), unsigned\",ylim=c(0,1)) abline(v=c(-1:1),col='grey') ; abline(h=c(0,1),col='grey') abline(h=0.5, lty=2, col='grey')  plot(R,sigmoidDistance(R,alpha=5,tau0 = 1,unsigned=FALSE, stretch=TRUE),type='l',lwd=3,      xlab=\"Correlation coefficient\", ylab=\"Sigmoid Distance\",     main = \"sigmoid(5, 1), unsigned, stretched\",ylim=c(0,1)) abline(v=c(-1:1),col='grey') ; abline(h=c(0,1),col='grey') abline(h=0.5, lty=2, col='grey') R <- c(-100:100)/100 ; R <- ifelse(R < -1, -1, ifelse(1 < R, 1, R))  par(mar = c(2, 2, 4, 2), mfrow=c(2,2))  plot(R,sigmoidDistance(R,alpha=4,tau0 = 1/4,unsigned=FALSE),type='l',lwd=3,      xlab=\"Correlation coefficient\", ylab=\"Sigmoid Distance\",     main = \"sigmoid(4, 1/4), unsigned\",ylim=c(0,1)) abline(v=c(-1:1),col='grey') ; abline(h=c(0,1),col='grey') abline(h=0.5, lty=2, col='grey')  plot(R,sigmoidDistance(R,alpha=10,tau0 = -1/4,unsigned=FALSE),type='l',lwd=3,      xlab=\"Correlation coefficient\", ylab=\"Sigmoid Distance\",     main = \"sigmoid(10, -1/4), unsigned\",ylim=c(0,1)) abline(v=c(-1:1),col='grey') ; abline(h=c(0,1),col='grey') abline(h=0.5, lty=2, col='grey')  plot(R,sigmoidDistance(R,alpha=20,tau0 = 1/4,unsigned=FALSE),type='l',lwd=3,      xlab=\"Correlation coefficient\", ylab=\"Sigmoid Distance\",     main = \"sigmoid(20, 1/4), unsigned\",ylim=c(0,1)) abline(v=c(-1:1),col='grey') ; abline(h=c(0,1),col='grey') abline(h=0.5, lty=2, col='grey')  plot(R,sigmoidDistance(R,alpha=100,tau0 = -1/4,unsigned=FALSE),type='l',lwd=3,      xlab=\"Correlation coefficient\", ylab=\"Sigmoid Distance\",     main = \"sigmoid(100, -1/4), unsigned\",ylim=c(0,1)) abline(v=c(-1:1),col='grey') ; abline(h=c(0,1),col='grey') abline(h=0.5, lty=2, col='grey') R <- c(-100:100)/100 ; R <- ifelse(R < -1, -1, ifelse(1 < R, 1, R))  par(mar = c(2, 2, 4, 2), mfrow=c(2,2))  plot(R,sigmoidDistance(R,alpha=1,tau0 = 1/2,unsigned=TRUE,stretch=TRUE),type='l',lwd=3,      xlab=\"Correlation coefficient\", ylab=\"Sigmoid Distance\",     main = \"sigmoid(1, 1/2), unsigned, stretched\",ylim=c(0,1)) abline(v=c(-1:1),col='grey') ; abline(h=c(0,1),col='grey') abline(h=0.5, lty=2, col='grey')  plot(R,sigmoidDistance(R,alpha=8,tau0 = 1,unsigned=TRUE,stretch=TRUE),type='l',lwd=3,      xlab=\"Correlation coefficient\", ylab=\"Sigmoid Distance\",     main = \"sigmoid(8, 1), unsigned, stretched\",ylim=c(0,1)) abline(v=c(-1:1),col='grey') ; abline(h=c(0,1),col='grey') abline(h=0.5, lty=2, col='grey')  plot(R,sigmoidDistance(R,alpha=4,tau0 = 0,unsigned=TRUE,stretch=TRUE),type='l',lwd=3,      xlab=\"Correlation coefficient\", ylab=\"Sigmoid Distance\",     main = \"sigmoid(4, 0), unsigned, stretched\",ylim=c(0,1)) abline(v=c(-1:1),col='grey') ; abline(h=c(0,1),col='grey') abline(h=0.5, lty=2, col='grey')  plot(R,sigmoidDistance(R,alpha=100,tau0 = 1/10,unsigned=TRUE,stretch=TRUE),type='l',lwd=3,      xlab=\"Correlation coefficient\", ylab=\"Sigmoid Distance\",     main = \"sigmoid(100, 1/10), unsigned, stretched\",ylim=c(0,1)) abline(v=c(-1:1),col='grey') ; abline(h=c(0,1),col='grey') abline(h=0.5, lty=2, col='grey')"},{"path":"https://longevity-consortium.github.io/standardcor/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Max Robinson. Maintainer.","code":""},{"path":"https://longevity-consortium.github.io/standardcor/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Robinson M, Pflieger L (2024). standardcor: Empirical Null Models Pairwise Correlations–Estimation Standardization. R package version 0.1.0, https://longevity-consortium.github.io/standardcor/.","code":"@Manual{,   title = {standardcor: Empirical Null Models of Pairwise Correlations--Estimation and Standardization},   author = {Max Robinson and Lance Pflieger},   year = {2024},   note = {R package version 0.1.0},   url = {https://longevity-consortium.github.io/standardcor/}, }"},{"path":"https://longevity-consortium.github.io/standardcor/reference/SparseSpearmanCor2.html","id":null,"dir":"Reference","previous_headings":"","what":"Sparse implementation of Spearman Correlation — SparseSpearmanCor2","title":"Sparse implementation of Spearman Correlation — SparseSpearmanCor2","text":"Computes Spearman correlations either among columns one sparse matrix (X) columns two sparse matrices (X, Y). implementation specific Spearman correlation highly efficient; efficiency results avoiding unnecessary computations involving ranks zero entries, well equivalence rank correlations ranks shifted constant. Copied without code changes, textual change comments, public blog repository     https://github.com/saketkc/blog/blob/main/2022-03-10/SparseSpearmanCorrelation2.ipynb owned Saket Choudhary Mumbai, India 23 Mar 2024","code":""},{"path":"https://longevity-consortium.github.io/standardcor/reference/SparseSpearmanCor2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sparse implementation of Spearman Correlation — SparseSpearmanCor2","text":"","code":"SparseSpearmanCor2(X, Y = NULL, cov = FALSE)"},{"path":"https://longevity-consortium.github.io/standardcor/reference/SparseSpearmanCor2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sparse implementation of Spearman Correlation — SparseSpearmanCor2","text":"X sparse data matrix Y second sparse data matrix. X provided, columns X correlated ; Y also specified, columns X cross-correlated columns Y. cov optional covariance matrix use computing correlations. Passed qlcMatrix::corSparse().","code":""},{"path":"https://longevity-consortium.github.io/standardcor/reference/SparseSpearmanCor2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sparse implementation of Spearman Correlation — SparseSpearmanCor2","text":"matrix M Spearman correlations. .null(Y), M[,j] = cor(X[,],X[,j],method='s'), otherwise M[,j] = cor(X[,],Y[j],method='s'). implementation considerably faster others X Y sparse.","code":""},{"path":"https://longevity-consortium.github.io/standardcor/reference/SparsifiedRanks2.html","id":null,"dir":"Reference","previous_headings":"","what":"Replace non-zero entries in a sparse matrix with non-zero ranks — SparsifiedRanks2","title":"Replace non-zero entries in a sparse matrix with non-zero ranks — SparsifiedRanks2","text":"Creates rank matrix sparse matrix X using following approach: 1. Use non-zero enries column calculate ranks 2. Add (z-1)/2 ranks (non-zero entries changed). z number zeros column Since entries shifted constant (zeros already shifted), covariance matrix shifted matrix rank matrix entire matrix (zeros also rank = (z+1)/2) z number zeros rank matrix can used calculate Spearman's correlation coefficient (via pearson correlation) Copied without code changes minor changes comments, public blog repository     https://github.com/saketkc/blog/blob/main/2022-03-10/SparseSpearmanCorrelation2.ipynb owned Saket Choudhary Mumbai, India 23 Mar 2024","code":""},{"path":"https://longevity-consortium.github.io/standardcor/reference/SparsifiedRanks2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Replace non-zero entries in a sparse matrix with non-zero ranks — SparsifiedRanks2","text":"","code":"SparsifiedRanks2(X)"},{"path":"https://longevity-consortium.github.io/standardcor/reference/SparsifiedRanks2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Replace non-zero entries in a sparse matrix with non-zero ranks — SparsifiedRanks2","text":"X sparse data matrix Y second sparse data matrix. X provided, columns X correlated ; Y also specified, columns X cross-correlated columns Y.","code":""},{"path":"https://longevity-consortium.github.io/standardcor/reference/SparsifiedRanks2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Replace non-zero entries in a sparse matrix with non-zero ranks — SparsifiedRanks2","text":"sparse matrix ranks non-zero entries","code":""},{"path":"https://longevity-consortium.github.io/standardcor/reference/betaDistance.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Dimensionally-adjusted correlation distances — betaDistance","title":"Calculate Dimensionally-adjusted correlation distances — betaDistance","text":"standard (Euclidean) transformation correlation coefficients distances based 2-dimensional geometry plane formed correlated vectors origin. However, simulations random vectors demonstrate probability correlations random vectors reaching given correlation coefficient depends number dimensions spanned random vectors. function allows transforming correlation coefficients distances reflect null distribution, corresponds Beta distribution can estimated bulk correlations assumption majority correlations null model.","code":""},{"path":"https://longevity-consortium.github.io/standardcor/reference/betaDistance.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Dimensionally-adjusted correlation distances — betaDistance","text":"","code":"betaDistance(r, v = 1, w = 1, mix = 1, unsigned = TRUE)"},{"path":"https://longevity-consortium.github.io/standardcor/reference/betaDistance.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Dimensionally-adjusted correlation distances — betaDistance","text":"r numeric object containing correlation coefficients v first shape parameter 2-parameter Beta distribution w second shape parameter 2-parameter Beta distribution mix relative weight squared Euclidean distance Beta distance penalty. mix = 0, Beta distance used correlation significantly beyond null distribution essentially zero distance. mix = 1, correlation corresponding zero distance +/-1, Beta distance acts penalty top squared Euclidean distance. intermediate values allowed, recommended. unsigned TRUE (default), computes distance association (|r|) instead correlation (r).","code":""},{"path":"https://longevity-consortium.github.io/standardcor/reference/betaDistance.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Dimensionally-adjusted correlation distances — betaDistance","text":"numeric object containing dimensionally-adjusted distances","code":""},{"path":"https://longevity-consortium.github.io/standardcor/reference/centerBeta.html","id":null,"dir":"Reference","previous_headings":"","what":"Center correlations — centerBeta","title":"Center correlations — centerBeta","text":"null distribution model r ~ 2 Beta(v,w) - 1 centering (target) distribution r_centered ~ 2 Beta(nu, nu) - 1","code":""},{"path":"https://longevity-consortium.github.io/standardcor/reference/centerBeta.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Center correlations — centerBeta","text":"","code":"centerBeta(r, v, w, nu)"},{"path":"https://longevity-consortium.github.io/standardcor/reference/centerBeta.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Center correlations — centerBeta","text":"r correlation center v first parameter Beta distribution w second parameter Beta distribution nu parameter target Beta distribution","code":""},{"path":"https://longevity-consortium.github.io/standardcor/reference/centerBeta.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Center correlations — centerBeta","text":"centered correlation","code":""},{"path":"https://longevity-consortium.github.io/standardcor/reference/estimateShape.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate parameters of a Beta distribution null model — estimateShape","title":"Estimate parameters of a Beta distribution null model — estimateShape","text":"function estimates shape parameters v w Beta(v,w) distribution fit bulk (background) distribution given set correlations. objective estimating process match density distribution mode breadth distribution around mode, goal estimating model bulk (null) distribution assumption correlation coefficents provided corSet contains modest number values drawn null distribution. Note possible provide infallible definition desired null model; method therefore necessarily heuristic provide satisfactory result cases. occurs, user encouraged use \"left\" \"right\" parameters needed provide satisfactory null model.","code":""},{"path":"https://longevity-consortium.github.io/standardcor/reference/estimateShape.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate parameters of a Beta distribution null model — estimateShape","text":"","code":"estimateShape(   corSet,   left = 0,   right = 0,   plot = FALSE,   fine = NULL,   trim = 0.01,   ... )"},{"path":"https://longevity-consortium.github.io/standardcor/reference/estimateShape.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate parameters of a Beta distribution null model — estimateShape","text":"corSet vector non-unique, non-self correlation coefficients. left adjustment estimated value w. parameter provided effect changing estimated v parameter can assessed plot. Note mean Beta(v,w) v/(v+w), adding w moves mean left. right adjustment estimated value v. Adding value v moves mean Beta distribution right; Adding v w decreases variance. plot TRUE, plot distribution shown, along fitted distribution Beta(v,w). ev ew estimated parameters, v = ev + right, w = ew + left. fine Half number bins histogram. fine = NULL (default), appropriate value 5 100 used. trim mean correlations estimated robustly making initial Beta model, trimming values quantile trim/2 quantile 1-trim/2 initial model (0 <= trim < 1). trimming reduces number correlations remain less five, trimming disabled full set correlations used.","code":""},{"path":"https://longevity-consortium.github.io/standardcor/reference/estimateShape.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate parameters of a Beta distribution null model — estimateShape","text":"vector c(v, w) containing two Beta parameters (see plot=TRUE ).","code":""},{"path":"https://longevity-consortium.github.io/standardcor/reference/euclidDistance.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Euclidean distance — euclidDistance","title":"Calculate Euclidean distance — euclidDistance","text":"Calculates distance network correlation coefficient matrix using Euclidean function.","code":""},{"path":"https://longevity-consortium.github.io/standardcor/reference/euclidDistance.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Euclidean distance — euclidDistance","text":"","code":"euclidDistance(mat, v = 1, w = 1, type = \"unsigned\")"},{"path":"https://longevity-consortium.github.io/standardcor/reference/euclidDistance.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Euclidean distance — euclidDistance","text":"mat matrix correlation coefficients v first parameter beta distribution w second parameter beta distribution type type distance calculate","code":""},{"path":"https://longevity-consortium.github.io/standardcor/reference/euclidDistance.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Euclidean distance — euclidDistance","text":"matrix distances","code":""},{"path":"https://longevity-consortium.github.io/standardcor/reference/interpolatedAdjacency.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert a (standardized) correlation value r to an adjacency — interpolatedAdjacency","title":"Convert a (standardized) correlation value r to an adjacency — interpolatedAdjacency","text":"Interpolates adjacency value 0..1 correlation value -1 <= r <= 1 tabulated soft thresholding function.","code":""},{"path":"https://longevity-consortium.github.io/standardcor/reference/interpolatedAdjacency.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert a (standardized) correlation value r to an adjacency — interpolatedAdjacency","text":"","code":"interpolatedAdjacency(r, adjTable)"},{"path":"https://longevity-consortium.github.io/standardcor/reference/interpolatedAdjacency.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert a (standardized) correlation value r to an adjacency — interpolatedAdjacency","text":"r numeric object containing (standardized) correlation coefficients adjTable tabulated soft-threshold adjacency function, produced nullModelAdjacencyTable()","code":""},{"path":"https://longevity-consortium.github.io/standardcor/reference/interpolatedAdjacency.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert a (standardized) correlation value r to an adjacency — interpolatedAdjacency","text":"numeric object containing adjacencies correlation network model","code":""},{"path":"https://longevity-consortium.github.io/standardcor/reference/multiOmicModel.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute Spearman correlations and normalization distributions within and between multiple datasets — multiOmicModel","title":"Compute Spearman correlations and normalization distributions within and between multiple datasets — multiOmicModel","text":"Manages computation Spearman correlations within multiple, potentially large ('Omics) datasets, returning matrix correlations pairs analytes. listed dataset expected numeric matrix containing numeric data, however input list can contain either matrix (referred internal datasets) large datasets, name RDS file containing dataset (external datasets). approach handle unlimited amount data; least, internal datasets every pair external datasets must fit memory simultaneously. function computes null models, separated block-wise construction standardized correlation matrix analytes provide opportunity null model parameters computed adjusted needed prior use standardization.","code":""},{"path":"https://longevity-consortium.github.io/standardcor/reference/multiOmicModel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute Spearman correlations and normalization distributions within and between multiple datasets — multiOmicModel","text":"","code":"multiOmicModel(OmicsL, common = TRUE, min.samples = 5, annotate = FALSE, ...)"},{"path":"https://longevity-consortium.github.io/standardcor/reference/multiOmicModel.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute Spearman correlations and normalization distributions within and between multiple datasets — multiOmicModel","text":"OmicsL named list datasets. dataset may matrix (internal dataset) name RDS file containing matrix (external dataset). matrices interpreted rows representing samples columns representing analytes; analyte names must unique across datasets. common TRUE (default), samples common datasets used compute correlations. Otherwise, correlations computed across samples shared individual pair datasets. requiring correlations depend common set samples, setting common FALSE permits available data contribute cross-correlation; user decide appropriate. min.samples lower limit number samples analyte-analyte correlations may computed. parameter used ensure datasets overlap sufficiently samples provide least minimal ability compute correlations analytes. common set samples required across datasets, parameter minimum length common set samples; otherwise min.samples minimum number samples shared pair 'Omics datasets independently.","code":""},{"path":"https://longevity-consortium.github.io/standardcor/reference/multiOmicModel.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute Spearman correlations and normalization distributions within and between multiple datasets — multiOmicModel","text":"list two parts: 'modelL', list Beta distributon null models raw correlation values every pair input ('Omics) datasets, 'analyteL', list analytes contributed 'Omics dataset. standardized correlation matrix can computed two lists using standardizeFromModel(), either directly adjustment individual null model parameters needed. rows columns final standardized correlation matrix labeled full set analytes listed analyteL, must unique; effort made render analyte names unique either functions.","code":""},{"path":"https://longevity-consortium.github.io/standardcor/reference/nullModelAdjacencyTable.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute soft threshold adjacency table for unsigned correlations from a symmetric Beta distribution null model — nullModelAdjacencyTable","title":"Compute soft threshold adjacency table for unsigned correlations from a symmetric Beta distribution null model — nullModelAdjacencyTable","text":"Tabulates soft thresholding function converting correlations directly adjacencies suitable network model set correlations among set analytes, example table transcriptomic, proteomic, metabolomic, 'Omics data. tabulated function uses background model random correlations expressed parameter nu: Prr | null model = Prx <= Beta(nu, nu) | x = (1+r)/2, estimate number correlations background model, estimate value r probability , given value misclassified, classified false negative. estimated number false negatives (FN) false positives (FP), probability FN / (FN + FP). serves appropriate soft-threshold function, probability 1/2 estimate number false negatives equals number false positives.","code":""},{"path":"https://longevity-consortium.github.io/standardcor/reference/nullModelAdjacencyTable.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute soft threshold adjacency table for unsigned correlations from a symmetric Beta distribution null model — nullModelAdjacencyTable","text":"","code":"nullModelAdjacencyTable(uniqueCor, v, scale = 2, bins = 100)"},{"path":"https://longevity-consortium.github.io/standardcor/reference/nullModelAdjacencyTable.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute soft threshold adjacency table for unsigned correlations from a symmetric Beta distribution null model — nullModelAdjacencyTable","text":"uniqueCor numeric object containing full set non-self, unique correlation values consider. analyte-analyte correlation matrix Z, non-self, unique correlations can found using Z[row(Z) < col(Z)]. v parameter null model random correlations, Prr | null model = Prx <= Beta(v, v) | x = (1+r)/2. scale Center soft threshold relative estimated number correlations beyond fit null model. Defaults 2; higher values increase connectivity network model, lower values decrease .","code":""},{"path":"https://longevity-consortium.github.io/standardcor/reference/nullModelAdjacencyTable.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute soft threshold adjacency table for unsigned correlations from a symmetric Beta distribution null model — nullModelAdjacencyTable","text":"data frame 2 columns, x y, tabulating y function x -1 <= x <= 1 0 <= y <= 1.","code":""},{"path":"https://longevity-consortium.github.io/standardcor/reference/powerDistance.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate power distance — powerDistance","title":"Calculate power distance — powerDistance","text":"Calculates distances WCNA correlation coefficient(s) using power function.","code":""},{"path":"https://longevity-consortium.github.io/standardcor/reference/powerDistance.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate power distance — powerDistance","text":"","code":"powerDistance(r, k, unsigned = TRUE)"},{"path":"https://longevity-consortium.github.io/standardcor/reference/powerDistance.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate power distance — powerDistance","text":"r Correlation coefficient(s), -1 <= r <= 1. k power parameter. unsigned TRUE, function computes distances based unsigned associations (|r|), otherwise computes distances based signed correlations (r).","code":""},{"path":"https://longevity-consortium.github.io/standardcor/reference/powerDistance.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate power distance — powerDistance","text":"matrix distances","code":""},{"path":"https://longevity-consortium.github.io/standardcor/reference/powerDistance.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate power distance — powerDistance","text":"Correlation distance transformed follows: type = \"unsigned\"= 1 - abs(r)^k; type = \"signed\" = ((1 - r)/2)^k","code":""},{"path":"https://longevity-consortium.github.io/standardcor/reference/sigmoidDistance.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate sigmoid distance — sigmoidDistance","title":"Calculate sigmoid distance — sigmoidDistance","text":"Calculates distances correlation coefficients using sigmoid function. WCNA converts correlations distances distances adjacencies construct adjacency matrix network model analyte relationships pairwise correlations; function used first step. distances can thought providing soft thresholding correlations. sigmoid function provides threshold parameter (tau0), specifies correlation value corresponding adjacency = 0.5; rate parameter (alpha > 0), controls \"hardness\" threshold.","code":""},{"path":"https://longevity-consortium.github.io/standardcor/reference/sigmoidDistance.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate sigmoid distance — sigmoidDistance","text":"","code":"sigmoidDistance(r, alpha, tau0, unsigned = TRUE, stretch = FALSE)"},{"path":"https://longevity-consortium.github.io/standardcor/reference/sigmoidDistance.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate sigmoid distance — sigmoidDistance","text":"r Correlation coefficient(s) alpha alpha parameter sigmoid function (log slope tau0) tau0 tau0 parameter sigmoid function (correlation value corresponding distance = 0.5) stretch TRUE, distances rescaled range 0..1. (default: stretch=FALSE) type interpretation correlation coefficient signed (correlation) unsigned (association, default). value \"unsigned\" interpreted signed.","code":""},{"path":"https://longevity-consortium.github.io/standardcor/reference/sigmoidDistance.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate sigmoid distance — sigmoidDistance","text":"distance(s) corresponding correlation coefficient(s)","code":""},{"path":"https://longevity-consortium.github.io/standardcor/reference/standardcor-package.html","id":null,"dir":"Reference","previous_headings":"","what":"standardcor: Empirical Null Models of Pairwise Correlations–Estimation and Standardization — standardcor-package","title":"standardcor: Empirical Null Models of Pairwise Correlations–Estimation and Standardization — standardcor-package","text":"package addresses issues arising using correlation coefficients determine adjacencies network representations systems interacting variables, measured quantities gene transcripts, proteins, metabolites, microRNAs, lipids, related measurements collected high-throughput technologies employed molecular biological research. methods specific application, statistical intended practical value regardless field application; however, package motivated issues arising stated application.","code":""},{"path":[]},{"path":"https://longevity-consortium.github.io/standardcor/reference/standardizeFromModel.html","id":null,"dir":"Reference","previous_headings":"","what":"Build a standardized correlation matrix using null models for each pair of component datasets — standardizeFromModel","title":"Build a standardized correlation matrix using null models for each pair of component datasets — standardizeFromModel","text":"Uses provided list null models (modelL) standardize type correlations target common null model specified v.std parameter, (r + 1)/2 ~ Beta(v.std, v.std), r standardized Spearman correlation coefficient two analytes modeled list 'Omics datasets. analtyes listed dataset components list parameter analtyeL, must unique contain analytes provided raw correlation matrix modelL. resulting standardized correlation matrix built blockwise full symmetric.","code":""},{"path":"https://longevity-consortium.github.io/standardcor/reference/standardizeFromModel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Build a standardized correlation matrix using null models for each pair of component datasets — standardizeFromModel","text":"","code":"standardizeFromModel(modelL, analyteL, v.std = 32)"},{"path":"https://longevity-consortium.github.io/standardcor/reference/standardizeFromModel.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Build a standardized correlation matrix using null models for each pair of component datasets — standardizeFromModel","text":"modelL list--lists structure providing two inputs pair 'Omics datasets B: matrix modelL[[]][[B]][['cor']] raw Spearman correlation values, shape parameters modelL[[]][[B]][['shape']] == c(v,w) specifying null model (1+r_raw)/2 ~ Beta(v,w) raw correlations. v.std  analtyeL 'Omics dataset , analyteL[[]] lists analytes provided dataset . analyte identifiers required unique across datasets.","code":""},{"path":"https://longevity-consortium.github.io/standardcor/reference/standardizeFromModel.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Build a standardized correlation matrix using null models for each pair of component datasets — standardizeFromModel","text":"symmetric matrix containing standardized Spearman correlation coefficients every pair analytes across datasets.","code":""}]
